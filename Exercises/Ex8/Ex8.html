
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>9.1. Potential Energy Scans and Visualisation of Trajectories &#8212; Introduction to Electronic Structure Methods</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"TeX": {"Macros": {"ket": ["\\lvert #1 \\rangle", 1], "bra": ["\\langle #1 \\lvert", 1], "Ket": ["\\lvert #1 \\rangle", 1], "Bra": ["\\langle #1 \\lvert", 1], "braket": ["\\langle #1 \\lvert #2 \\rangle", 2], "hop": "\\hat{\\mathcal{H}}", "unit": "\\mathbbm{1}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Exercises/Ex8/Ex8';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Basis functions in quantum chemistry" href="../../Lecture/BasisFunctions.html" />
    <link rel="prev" title="9. Potential Energy Scans and Visualisation of Trajectories" href="IESM_Ex8.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Introduction to Electronic Structure Methods</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Introduction to Electronic Structure Methods
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Exercises</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex1/IESM_Ex1.html">1. Linear Algebra in Quantum Mechanics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex1/Ex1_LinearAlgebra.html">1.1. Review of Linear Algebra Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex1/Ex1_QM.html">1.2. Basic Concepts in Quantum Mechanics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex1/Ex1_Numpy.html">1.3. Working with vectors using Numpy</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex2/IESM_Ex2.html">2. First steps in <em>Psi4</em></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex2/Ex2_theory.html">2.1. Basis Sets - Defining Vector Spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex2/Ex2_hydrogen_atom.html">2.2. The Hydrogen Atom</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex2/Ex2_water-molecule.html">2.3. A more complex system: H<span class="math notranslate nohighlight">\(_{2}\)</span>O</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex3/IESM_Ex3.html">3. Large Basis Sets, Dissociation Energy and Geometry Optimisation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/Ex3_H2molecule.html">3.1. Effects of Basis Set Size: The Molecular Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/Ex3_Dissociation.html">3.2. Recording a Dissociation Curve for H<span class="math notranslate nohighlight">\(_2\)</span>: RHF vs. UHF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/Ex3_GeometryOpt.html">3.3. Geometry optimization of <span class="math notranslate nohighlight">\(H_2O\)</span></a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex4/IESM_Ex4b.html">4. The hartree fock procedure in detail</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex4/HF.html">4.1. Hartree-Fock Procedure for Approximate Quantum Chemistry</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex5/IESM_Ex5.html">5. Post-Hartree Fock Methods: CI and MPn</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex5/Ex5Theory.html">5.1. Post-Hartree Fock Methods: Theory Recap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex5/Ex5_Boron.html">5.2. Recovering Correlation Energy: B atom</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex5/Ex5_BDE.html">5.3. Homolytic Cleavage of the C-F Bond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex5/Ex5_HNO3.html">5.4. Influence of correlation on geometry: HNO<span class="math notranslate nohighlight">\(_3\)</span> molecule</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex6/IESM_Ex6.html">6. DFT vs (Post) HF Methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex6/Ex6_aval.html">6.1. Methylcyclohexane A-value</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex6/Ex6_geo.html">6.2. Geometric properties:  NO<span class="math notranslate nohighlight">\(_3\cdot\)</span> radical</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex7/IESM_Ex7.html">7. Troubleshooting, Pitfalls, Traps</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex7/Ex7_errors.html">7.1. Fixing errors in the calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex7/Ex7_DFT_Hard_Easy.html">7.2. Hard and easy cases for DFT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex7/Ex7_DFT_integration_grid.html">7.3. Integration grids</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex9/IESM_Ex9.html">8. Finding Transition States and Barrier Heights: First Order Saddle Points</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex9/Ex9Theory.html">8.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex9/Ex9.html">8.2. Locating Transition States: Constrained Optimisations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex9/Backward.html">8.3. Recording a Potential Energy Profile: The Intrinsic Reaction Coordinate (IRC)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Ex9/Visualize.html">8.5. IRC analysis</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="IESM_Ex8.html">9. Potential Energy Scans and Visualisation of Trajectories</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">9.1. Potential Energy Scans and Visualisation of Trajectories</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Lecture/BasisFunctions.html">Basis functions in quantum chemistry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Lecture/CC.html">Coupled cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Lecture/FAQ.html">FAQ</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://noto.epfl.ch/hub/user-redirect/git-pull?repo=https%3A//github.com/lcbc-epfl/iesm-public&urlpath=lab/tree/iesm-public/iesm/Exercises/Ex8/Ex8.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/lcbc-epfl/iesm-public" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/lcbc-epfl/iesm-public/issues/new?title=Issue%20on%20page%20%2FExercises/Ex8/Ex8.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Exercises/Ex8/Ex8.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Potential Energy Scans and Visualisation of Trajectories</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scanning-a-potential-energy-surface-dihedral-scan-of-butane">9.1.1. Scanning a Potential Energy Surface: Dihedral Scan of Butane</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-geometry">9.1.1.1. Starting geometry</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pes-scan">9.1.1.2. PES scan</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization-of-the-results">9.1.1.3. Visualization of the Results</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="potential-energy-scans-and-visualisation-of-trajectories">
<h1><span class="section-number">9.1. </span>Potential Energy Scans and Visualisation of Trajectories<a class="headerlink" href="#potential-energy-scans-and-visualisation-of-trajectories" title="Link to this heading">#</a></h1>
<p>The range of problems that can be tackled with Psi4 or other electronic structure packages is not limited
to wavefunction or geometry optimisations. We can use python to create complex inputs, adjusting various settings, or making specific modifications of
some variables.</p>
<p>In this set of exercises, you will instruct Psi4 to
selectively scan one degree of freedom of a potential energy surface.</p>
<section id="scanning-a-potential-energy-surface-dihedral-scan-of-butane">
<h2><span class="section-number">9.1.1. </span>Scanning a Potential Energy Surface: Dihedral Scan of Butane<a class="headerlink" href="#scanning-a-potential-energy-surface-dihedral-scan-of-butane" title="Link to this heading">#</a></h2>
<p>Potential energy surfaces (PES) are complex objects which are, in
general, 3N-6 dimensional, where N is the number of atoms. Therefore, obtaining the complete topology of
a PES is not feasible for most molecules. However, one may limit the
sampling of the surface to a few degrees of freedom that are of interest
and relevant to the problem under examination (<em>cf.</em> figure 1). Scans
along limited degrees of freedom may be helpful if one needs information
about various possible (local) minima, for example if (or whether) one
is trapped in one of them. In practice, the degrees of freedom can be
defined by a Z-matrix, such as the one that you have already been using
in the previous exercises.</p>
<figure class="align-default" id="pes">
<img alt="../../_images/pesslize.jpg" src="../../_images/pesslize.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 9.1 </span><span class="caption-text">Example of a 2D PES (right) and a 1D potential energy profile (left)
obtained by considering only one degree of freedom.</span><a class="headerlink" href="#pes" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>In a <em>relaxed PES scan</em>, all degrees of freedom that are not under
consideration are optimised, and one obtains a minimum energy path along
the chosen degree(s) of freedom. This implies that a constrained
optimisation is carried out for each desired value of the degree of
freedom that is being sampled.
Instead, one may freeze the remaining degrees of
freedom, keeping them fixed at their initial values, lowering the computational cost. This procedure is
referred to as a <em>rigid PES scan</em>. For simple scans of bond angles or
lengths in a pre-optimised structure, this is often sufficient (and more
efficient).</p>
<p>In this exercise, you will perform a relaxed potential energy
scan of the dihedral in butane in order to determine the possible
configurational minima, and the rotational barrier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">psi4</span>
<span class="kn">import</span> <span class="nn">py3Dmol</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi4</span><span class="o">.</span><span class="n">set_num_threads</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">set_memory</span><span class="p">(</span><span class="s1">&#39;2 GB&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000000000
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Threads set to 2 by Python driver.

  Memory set to   1.863 GiB by Python driver.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">helpers</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
<section id="starting-geometry">
<h3><span class="section-number">9.1.1.1. </span>Starting geometry<a class="headerlink" href="#starting-geometry" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">butane</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">C       </span>
<span class="s2">C    1    1.450000</span>
<span class="s2">C    1    1.450000      2  109.471000</span>
<span class="s2">H    1 1.089         2 109.471000         3 120</span>
<span class="s2">H    1 1.089        2 109.471000          3 -120</span>
<span class="s2">C    2 1.45         1 109.471000         3 180</span>
<span class="s2">H    2 1.089        1 109.471000        6 120</span>
<span class="s2">H    2 1.089         1 109.471000          6 240</span>
<span class="s2">H    3 1.089         1 109.471000          2 180</span>
<span class="s2">H    3 1.089        1 109.471000         9 120</span>
<span class="s2">H    3 1.089        1 109.471000         9 240</span>
<span class="s2">H    6 1.089        2 109.471000         1 180</span>
<span class="s2">H    6 1.089       2 109.471000        12 120</span>
<span class="s2">H    6 1.089        2 109.471000        12 240</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drawXYZ_labeled</span><span class="p">(</span><span class="n">butane</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div id="3dmolviewer_16309159503493316"  style="position: relative; width: 400px; height: 400px">
        <p id="3dmolwarning_16309159503493316" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
      resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://3dmol.org/build/3Dmol.js');
}

var viewer_16309159503493316 = null;
var warn = document.getElementById("3dmolwarning_16309159503493316");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_16309159503493316 = $3Dmol.createViewer($("#3dmolviewer_16309159503493316"),{backgroundColor:"white"});
viewer_16309159503493316.zoomTo();
	viewer_16309159503493316.addModel("14\n\n C    0.000000000000    0.773534000000    0.000000000000\n C    0.000000000000   -0.773534000000    0.000000000000\n C   -1.416736300374    1.389201068020    0.000000000000\n H    0.558366218163    1.136226796671    0.885329818893\n H    0.558366218163    1.136226796671   -0.885329818893\n C    1.416736300374   -1.389201068020    0.000000000000\n H   -0.558366218163   -1.136226796671    0.885329818893\n H   -0.558366218163   -1.136226796671   -0.885329818893\n H   -1.376626888385    2.493019581309    0.000000000000\n H   -1.990268077677    1.075434307189   -0.891478057070\n H   -1.990268077677    1.075434307189    0.891478057070\n H    1.376626888385   -2.493019581309    0.000000000000\n H    1.990268077677   -1.075434307189   -0.891478057070\n H    1.990268077677   -1.075434307189    0.891478057070\n","xyz");
	viewer_16309159503493316.addLabel("0",{"position": {"x": 0.0, "y": 0.7735340000017686, "z": 0.0}, "inFront": true});
	viewer_16309159503493316.addLabel("1",{"position": {"x": 0.0, "y": -0.7735340000017686, "z": 0.0}, "inFront": true});
	viewer_16309159503493316.addLabel("2",{"position": {"x": -1.4167363003770228, "y": 1.3892010680230642, "z": 0.0}, "inFront": true});
	viewer_16309159503493316.addLabel("3",{"position": {"x": 0.5583662181646449, "y": 1.1362267966736745, "z": 0.885329818894876}, "inFront": true});
	viewer_16309159503493316.addLabel("4",{"position": {"x": 0.5583662181646449, "y": 1.1362267966736745, "z": -0.8853298188948759}, "inFront": true});
	viewer_16309159503493316.addLabel("5",{"position": {"x": 1.4167363003770228, "y": -1.389201068023064, "z": 0.0}, "inFront": true});
	viewer_16309159503493316.addLabel("6",{"position": {"x": -0.5583662181646449, "y": -1.1362267966736745, "z": 0.8853298188948759}, "inFront": true});
	viewer_16309159503493316.addLabel("7",{"position": {"x": -0.5583662181646449, "y": -1.1362267966736745, "z": -0.8853298188948759}, "inFront": true});
	viewer_16309159503493316.addLabel("8",{"position": {"x": -1.3766268883884514, "y": 2.4930195813143166, "z": 0.0}, "inFront": true});
	viewer_16309159503493316.addLabel("9",{"position": {"x": -1.9902680776814123, "y": 1.075434307191404, "z": -0.8914780570719983}, "inFront": true});
	viewer_16309159503493316.addLabel("10",{"position": {"x": -1.9902680776814121, "y": 1.075434307191404, "z": 0.8914780570719983}, "inFront": true});
	viewer_16309159503493316.addLabel("11",{"position": {"x": 1.3766268883884514, "y": -2.4930195813143166, "z": 0.0}, "inFront": true});
	viewer_16309159503493316.addLabel("12",{"position": {"x": 1.9902680776814123, "y": -1.075434307191404, "z": -0.8914780570719983}, "inFront": true});
	viewer_16309159503493316.addLabel("13",{"position": {"x": 1.9902680776814123, "y": -1.075434307191404, "z": 0.8914780570719983}, "inFront": true});
	viewer_16309159503493316.setStyle({"stick": {}, "sphere": {"scale": 0.1}});
	viewer_16309159503493316.setStyle({"model": 0},{"stick": {"colorscheme": "yellowCarbon"}, "sphere": {"scale": 0.1}});
	viewer_16309159503493316.zoomTo();
viewer_16309159503493316.render();
});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drawXYZ</span><span class="p">(</span><span class="n">butane</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div id="3dmolviewer_16309146880341885"  style="position: relative; width: 400px; height: 400px">
        <p id="3dmolwarning_16309146880341885" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
      resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://3dmol.org/build/3Dmol.js');
}

var viewer_16309146880341885 = null;
var warn = document.getElementById("3dmolwarning_16309146880341885");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_16309146880341885 = $3Dmol.createViewer($("#3dmolviewer_16309146880341885"),{backgroundColor:"white"});
viewer_16309146880341885.zoomTo();
	viewer_16309146880341885.addModel("14\n\n C    0.000000000000    0.725000000000    0.000000000000\n C    0.000000000000   -0.725000000000    0.000000000000\n C   -1.367074971503    1.208328069007    0.000000000000\n H    0.513360222058    1.087996046309    0.889165987188\n H    0.513360222058    1.087996046309   -0.889165987188\n C    1.367074971503   -1.208328069007    0.000000000000\n H   -0.513360222058   -1.087996046309    0.889165987188\n H   -0.513360222058   -1.087996046309   -0.889165987188\n H   -1.367074971503    2.297328069007    0.000000000000\n H   -1.880429602190    0.845324115338   -0.889165987188\n H   -1.880429602190    0.845324115338    0.889165987188\n H    1.367074971503   -2.297328069007    0.000000000000\n H    1.880429602190   -0.845324115338   -0.889165987188\n H    1.880429602190   -0.845324115338    0.889165987188\n","xyz");
	viewer_16309146880341885.setStyle({"stick": {}, "sphere": {"scale": 0.1}});
	viewer_16309146880341885.zoomTo();
viewer_16309146880341885.render();
});
</script></div></div>
</div>
</section>
<section id="pes-scan">
<h3><span class="section-number">9.1.1.2. </span>PES scan<a class="headerlink" href="#pes-scan" title="Link to this heading">#</a></h3>
<p>Now that we had a look at the butane molecule, let’s perform the rigid PES scan. We will fix the dihedral angle at different values and do single point calculations.
First, we need to optimize the the geometry provided above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">clean_options</span><span class="p">()</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">clean_variables</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do Something HERE</span>
<span class="c1"># optimize the butane molecule from the starting geometry provided</span>
<span class="c1"># use the blyp method and the 6-31+G* basis set</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dihedrals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">37</span><span class="p">)</span> <span class="c1">#We set here the dihedrals that we are going to use for the scan</span>
<span class="n">PES</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1">#Here we will store the optimized energy for each dihedral. This is a dictionary</span>
<span class="n">geometries</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#Here we will store the optimized geometries. This is a list</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">butane</span><span class="o">.</span><span class="n">print_in_input_format</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The geometry optimization will print you the optimized coordinates in the format you provided them at the end if you call <code class="docutils literal notranslate"><span class="pre">butane.print_in_input_format()</span></code>. Here, this is the z-matrix format. Use these coordinates below and create a python f-string where you replace the dihedral that we want to scan with a variable.</p>
<p>Save the molecules in the <code class="docutils literal notranslate"><span class="pre">geometries</span></code> list (use <code class="docutils literal notranslate"><span class="pre">butane.clone()</span></code>) and save the calculated energies in the <code class="docutils literal notranslate"><span class="pre">PES</span></code> dictionary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">set_output_file</span><span class="p">(</span><span class="s1">&#39;output.dat&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do something HERE </span>
<span class="c1">#for dihedral in dihedrals:</span>
<span class="c1">#    print(f&quot;optimizing {dihedral}&quot;)</span>
<span class="c1">#    butane = psi4.geometry(f&quot;&quot;&quot;  #you get this geometry from the print_in_input_format() command</span>
<span class="c1">#    x i bond k angle j {dihedral} #this is the dihedral we want to optimize</span>
<span class="c1">#    x i bond k angle j dihedral</span>
<span class="c1">#    &quot;&quot;&quot;)</span>
<span class="c1">#    E = .... # the energy should be calculated using the same method and basis set above</span>
<span class="c1">#    PES[dihedral] =  set to energy just calculated</span>
<span class="c1">#    geometries.append( insert clone of molecule here   )</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert the energy units to kcal/mol</span>
<span class="c1"># you can use psi4.constants.hartree2kcalmol for the unit conversion </span>
<span class="c1"># in python you can use list comprehensions e.g [x+1 for x in lst] will increase every value in lst by 1.</span>
<span class="c1"># to access the values in the dictionary PES you can use PES.values() which return a list.</span>
<span class="c1"># to construct the list comprehensions set energies equal to... .</span>
<span class="c1"># [e*conversionfactor for e in list(insert the call to the list of PES values here)].</span>
<span class="n">energies</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1">#Rescale the energy scale by setting the minimum value as the zero of the scale</span>
<span class="c1">#and change everything accordingly</span>
<span class="c1"># the function np.min(lst) returns the lowest value of a list. </span>
<span class="c1"># to use broadcasting you need to convert the list into a np.array by calling np.array(energies)</span>
<span class="n">energies</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 180.,  170.,  160.,  150.,  140.,  130.,  120.,  110.,  100.,
         90.,   80.,   70.,   60.,   50.,   40.,   30.,   20.,   10.,
          0.,  -10.,  -20.,  -30.,  -40.,  -50.,  -60.,  -70.,  -80.,
        -90., -100., -110., -120., -130., -140., -150., -160., -170.,
       -180.])
</pre></div>
</div>
</div>
</div>
<p>For relaxed scans you can use such a input structure. However, in the interest of time we perform a rigid scan here.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">dihedral</span> <span class="ow">in</span> <span class="n">dihedrals</span><span class="p">:</span>
    <span class="n">psi4</span><span class="o">.</span><span class="n">set_options</span><span class="p">({</span>
        <span class="s2">&quot;fixed_dihedral&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;4 2 1 3 </span><span class="si">{</span><span class="n">dihedral</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="c1">#This option specifies the dihedral angles between atoms to be fixed </span>
    <span class="p">})</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="s1">&#39;blyp/6-31+G*&#39;</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="n">butane</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="visualization-of-the-results">
<h3><span class="section-number">9.1.1.3. </span>Visualization of the Results<a class="headerlink" href="#visualization-of-the-results" title="Link to this heading">#</a></h3>
<p>Now, let’s plot the PES at the different dihedral considered. You can use a little helper function which will read in the optimized geometries just calculated and the dihedrals and return the PES and the corresponding geometry at each dihedral value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span> <span class="o">=</span> <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">save_string_xyz_file</span><span class="p">()</span> <span class="k">for</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">geometries</span><span class="p">]</span>
<span class="n">traj_arrays</span> <span class="o">=</span> <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">to_arrays</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">geometries</span><span class="p">]</span>

<span class="n">drawXYZGeomSliderMolecularProperty</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dihedrals</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="s1">&#39;dihedral&#39;</span><span class="p">)</span>
<span class="c1"># for the slider to function properly you must have dihedral angles of exact integers. </span>
<span class="c1"># If that is not the case, adjust the number of dihedrals to divide -180 to 180 degrees into even steps (including the zero value).</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f3bc489d6be8430f9bb97e2328e1a27b", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>Now, we can monitor different quantities during the rigid PES scan, to understand how the different dihedrals affect the overall geometry. One example is the bond length between C atoms 1 and 2, the central atoms of the dihedral for which we performed the scan. Having a look at the fluctuations of this bond legth during the scan can be easily done using one of the helper functions, which will read the coordinates of the two atoms and calculate their distance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bond_length</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">traj_arrays</span><span class="p">:</span>
    <span class="n">bond_length</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">calculate_bond</span><span class="p">(</span><span class="n">geom</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">geom</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="c1">#Here the bond length is calculated and saved in the list</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dihedrals</span><span class="p">,</span> <span class="n">bond_length</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;dihedral&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;bond [A]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dihedrals</span><span class="p">,</span> <span class="n">bond_length</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;dihedral&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;bond [A]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a233c5266bffb3839c24a73ad2f849c8dfc39ac7a13b545707edac5747379e0c.png" src="../../_images/a233c5266bffb3839c24a73ad2f849c8dfc39ac7a13b545707edac5747379e0c.png" />
</div>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 2</p>
<p>Does the bond length of the <span class="math notranslate nohighlight">\(H_3CH_2C-CH_2CH_3\)</span> bond fluctuate as
the dihedral is changed? Why (not)?</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 3</p>
<p>Create a potential energy profile along the dihedral by plotting the
energies of the system as a function of the scanned dihedral angle as done above.
Then, to each maximum and minimum, assign the corresponding
conformation from your trajectory. Show these conformations in your
report.
Assign also names to the conformations according to the <em>Newman
projections</em> you know from organic chemistry (where possible).</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 4</p>
<p>The rotational barrier of butane lies between 5 and 6 kcal
mol<span class="math notranslate nohighlight">\(^{-1}\)</span> [^Murcko1996]. Compare this value with the one you calculated and explain possible sources of error, leading to higher or lower barriers.</p>
</div>
<p>[^Murcko1996] : Murcko M. A., Castejon H., Wiberg K.B., J. Phys. Chem., 1996, 100, 16162</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "psi4"
        },
        kernelOptions: {
            name: "psi4",
            path: "./Exercises/Ex8"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'psi4'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="IESM_Ex8.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">9. </span>Potential Energy Scans and Visualisation of Trajectories</p>
      </div>
    </a>
    <a class="right-next"
       href="../../Lecture/BasisFunctions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Basis functions in quantum chemistry</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scanning-a-potential-energy-surface-dihedral-scan-of-butane">9.1.1. Scanning a Potential Energy Surface: Dihedral Scan of Butane</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-geometry">9.1.1.1. Starting geometry</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pes-scan">9.1.1.2. PES scan</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization-of-the-results">9.1.1.3. Visualization of the Results</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Laboratory of Computational Biochemistry and Chemistry  - Prof. Ursula Roethlisberger
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>