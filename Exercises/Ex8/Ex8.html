
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>9.2. Locating Transition States: Constrained Optimisations &#8212; Introduction to Electronic Structure Methods</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="9.3. Recording a Potential Energy Profile: The Intrinsic Reaction Coordinate (IRC)" href="Backward.html" />
    <link rel="prev" title="9.1. Theory" href="Ex8Theory.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Introduction to Electronic Structure Methods</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Introduction to Electronic Structure Methods
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Exercises
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex1/IESM_Ex1.html">
   1. Linear Algebra in Quantum Mechanics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex1/Ex1_LinearAlgebra.html">
     1.1. Review of Linear Algebra Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex1/Ex1_QM.html">
     1.2. Basic Concepts in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex1/Ex1_Numpy.html">
     1.3. Working with vectors using Numpy
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex2/IESM_Ex2.html">
   2. First steps in
   <em>
    Psi4
   </em>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex2/Ex2_theory.html">
     2.1. Basis Sets - Defining Vector Spaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex2/Ex2_hydrogen_atom.html">
     2.2. The Hydrogen Atom
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex2/Ex2_water-molecule.html">
     2.3. A more complex system: H
     <span class="math notranslate nohighlight">
      \(_{2}\)
     </span>
     O
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex3/IESM_Ex3.html">
   3. Large Basis Sets, Dissociation Energy and Geometry Optimisation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/Ex3.html">
     3.1. Effects of Basis Set Size: The Molecular Case
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/Ex3Diss.html">
     3.2. Recording a Dissociation Curve for H
     <span class="math notranslate nohighlight">
      \(_2\)
     </span>
     : RHF vs. UHF
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/Ex3GeoOpt.html">
     3.3. Geometry optimization of
     <span class="math notranslate nohighlight">
      \(H_2O\)
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex4/IESM_Ex4b.html">
   4. The hartree fock procedure in detail
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/HF.html">
     4.1. Hartree-Fock Procedure for Approximate Quantum Chemistry
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex4/IESM_Ex4.html">
   5. Post-Hartree Fock Methods: MPn and Configuration Interaction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/Ex4Theory.html">
     5.1. MÃ¸ller-Plesset Perturbation Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/BDE.html">
     5.2. Homolytic Cleavage of the C-F Bond
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/HNO3_Correlation.html">
     5.5. Correlation energy
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex5/IESM_Ex5.html">
   6. Density Functional Theory - Comparison with (Post) Hartree-Fock Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex6/IESM_Ex6.html">
   7. Troubleshooting, Pitfalls, Traps
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex6/Ex6.html">
     7.1. Fixing errors in the calculations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex6/Ex6_DFT_Hard_Easy.html">
     7.2. Hard and easy cases for DFT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex6/Ex6_DFT_integration_grid.html">
     7.3. Integration grids
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex7/IESM_Ex7.html">
   8. Potential Energy Scans and Visualisation of Trajectories
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex7/Ex7.html">
     8.1. Potential Energy Scans and Visualisation of Trajectories
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="IESM_Ex8.html">
   9. Finding Transition States and Barrier Heights: First Order Saddle Points
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Ex8Theory.html">
     9.1. Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     9.2. Locating Transition States: Constrained Optimisations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Backward.html">
     9.3. Recording a Potential Energy Profile: The Intrinsic Reaction Coordinate (IRC)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Forward.html">
     9.5. Forward
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Visualize.html">
     9.6. IRC analysis
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lecture
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Lecture/BasisFunctions.html">
   Basis functions in quantum chemistry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Lecture/CC.html">
   Coupled cluster
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Lecture/FAQ.html">
   FAQ
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://noto.epfl.ch/hub/user-redirect/git-pull?repo=https%3A//github.com/lcbc-epfl/iesm-public&urlpath=lab/tree/iesm-public/iesm/Exercises/Ex8/Ex8.ipynb&branch=main"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/lcbc-epfl/iesm-public"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/lcbc-epfl/iesm-public/issues/new?title=Issue%20on%20page%20%2FExercises/Ex8/Ex8.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/Exercises/Ex8/Ex8.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#constructing-a-guess">
   9.2.1. Constructing a Guess
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#constrained-optimization">
   9.2.2. Constrained optimization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#finding-the-transition-state">
   9.2.3. Finding the Transition State
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Locating Transition States: Constrained Optimisations</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#constructing-a-guess">
   9.2.1. Constructing a Guess
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#constrained-optimization">
   9.2.2. Constrained optimization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#finding-the-transition-state">
   9.2.3. Finding the Transition State
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="locating-transition-states-constrained-optimisations">
<h1><span class="section-number">9.2. </span>Locating Transition States: Constrained Optimisations<a class="headerlink" href="#locating-transition-states-constrained-optimisations" title="Permalink to this headline">#</a></h1>
<p>Unlike a geometry optimisation, a transition state search requires more
than just <em>some</em> guess. Finding the transition state from a reactant or
a product structure will be computationally unfeasible, as those
structures are given by local minima on the PES. Hence, all possible
paths originating from these minima will go uphill (recall the
mathematical definition of a minimum with respect to its derivatives),
and it cannot be clear in advance which paths will actually connect
reactants and products, or which path(s) will proceed <em>via</em> the lowest
lying transition state. Instead, one needs a guess that is reasonably
close to the real transition state, such that the <em>curvature</em> of the
potential energy surface close to the TS is known, making it possible to
proceed uphill along the reaction coordinate until the transition state
is reached. The general procedure for a transition state search includes
the construction of a guess geometry that should be reasonably close to
the expected TS, followed by a <em>constrained optimisation</em> (<em>cf.</em> figure
3).</p>
<figure class="align-default" id="tssearch">
<img alt="../../_images/miniumenergypath.png" src="../../_images/miniumenergypath.png" />
<figcaption>
<p><span class="caption-number">Fig. 9.3 </span><span class="caption-text">Finding a transition state from an initial guess by performing a
constrained optimisation followed by a TS
search.</span><a class="headerlink" href="#tssearch" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>In a constrained optimisation, all degrees of freedom which are not
deemed relevant for the reaction are relaxed, whereas the relevant
degree(s) of freedom is (are) kept fixed. After the optimisation, the
curvature of the PES is evaluated at the chosen geometry (either
analytically or numerically, <em>cf.</em> the following section). If the
constrained degree(s) of freedom was (were) suitably chosen, the paths
associated to the unconstrained N-1 degrees of freedom will go uphill in
both directions, indicating that the corresponding structural parameters
were properly relaxed. There should be one degree of freedom remaining
that is associated to a path that goes downhill on one side and uphill
on the other side: This will be the path that leads uphill to the
transition state. As the associated degree of freedom is then known, the
geometry can then be optimised to a transition state by selectively
âwalking uphillâ along this specific path.</p>
<section id="constructing-a-guess">
<h2><span class="section-number">9.2.1. </span>Constructing a Guess<a class="headerlink" href="#constructing-a-guess" title="Permalink to this headline">#</a></h2>
<p>You can find below the Z-matrix for the chloropropanoate (2-Chloro-1-propanol) already set, obtained using the Open Source Software <a class="reference external" href="https://avogadro.cc/">Avogadro</a>. We want to set the Z-matrix for the transition state editing this matrix. Correct the parameters adapting the conformation to be reasonably close to the transition state: for the TS, one expects that the C-Cl bond will already be elongated, whereas the oxygen atom will start to form the epoxide ring. Change the bond angle of the oxygen atom to something smaller than the original value, such as 80â¦, and modify the bond length for the C-Cl bond to an elongated conformation, such as 2.40 Ã. Moreover, you need to delete the hydrogen bond to the oxygen atom, and edit the Z-matrix accordingly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">psi4</span>
<span class="kn">import</span> <span class="nn">py3Dmol</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">psi4</span><span class="o">.</span><span class="n">set_num_threads</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">set_memory</span><span class="p">(</span><span class="s1">&#39;2 GB&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">helpers</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Threads set to 2 by Python driver.

  Memory set to   1.863 GiB by Python driver.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Z-matrix for the chloropropanoate</span>
<span class="n">chloropropanoate</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">0 1</span>
<span class="s2"> symmetry c1</span>
<span class="s2"> c</span>
<span class="s2"> c    1 cc2</span>
<span class="s2"> cl   1 clc3        2 clcc3</span>
<span class="s2"> h    1 hc4         2 hcc4          3 dih4</span>
<span class="s2"> c    1 cc5         2 ccc5          3 dih5</span>
<span class="s2"> o    2 oc6         1 occ6          3 dih6</span>
<span class="s2"> h    2 hc7         1 hcc7          6 dih7</span>
<span class="s2"> h    2 hc8         1 hcc8          6 dih8</span>
<span class="s2"> h    5 hc9         1 hcc9          2 dih9</span>
<span class="s2"> h    5 hc10        1 hcc10         9 dih10</span>
<span class="s2"> h    5 hc11        1 hcc11         9 dih11</span>
<span class="s2"> h    6 ho          2 hoc2          1 dih12</span>
<span class="s2"> </span>
<span class="s2">cc2     =    1.500000</span>
<span class="s2">clc3    =    1.790000 </span>
<span class="s2">clcc3   =    109.471</span>
<span class="s2">hc4     =    1.089000</span>
<span class="s2">hcc4    =    109.471</span>
<span class="s2">dih4    =    100.000</span>
<span class="s2">cc5     =    1.500000</span>
<span class="s2">ccc5    =    109.471</span>
<span class="s2">dih5    =   -100.000</span>
<span class="s2">oc6     =    1.430000</span>
<span class="s2">occ6    =    110.600  </span>
<span class="s2">dih6    =    180.000</span>
<span class="s2">hc7     =    1.070000</span>
<span class="s2">hcc7    =    109.471</span>
<span class="s2">dih7    =    120.000</span>
<span class="s2">hc8     =    1.070000</span>
<span class="s2">hcc8    =    109.471</span>
<span class="s2">dih8    =    240.000</span>
<span class="s2">hc9     =    1.070000</span>
<span class="s2">hcc9    =    109.471</span>
<span class="s2">dih9    =    180.000</span>
<span class="s2">hc10    =    1.070000</span>
<span class="s2">hcc10   =    109.471</span>
<span class="s2">dih10   =    120.000</span>
<span class="s2">hc11    =    1.070000</span>
<span class="s2">hcc11   =    109.471</span>
<span class="s2">dih11   =    240.000</span>
<span class="s2">ho      =    0.97       </span>
<span class="s2">hoc2    =    109.471    </span>
<span class="s2">dih12   =    180.0      </span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="c1">#Edit the Z-matrix to obtain the TS guess according to the requests above</span>
<span class="n">ts_guess</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">0 1</span>
<span class="s2"> symmetry c1</span>
<span class="s2"> c</span>
<span class="s2"> c    1 cc2</span>
<span class="s2"> cl   1 clc3        2 clcc3</span>
<span class="s2"> h    1 hc4         2 hcc4          3 dih4</span>
<span class="s2"> c    1 cc5         2 ccc5          3 dih5</span>
<span class="s2"> o    2 oc6         1 occ6          3 dih6</span>
<span class="s2"> h    2 hc7         1 hcc7          6 dih7</span>
<span class="s2"> h    2 hc8         1 hcc8          6 dih8</span>
<span class="s2"> h    5 hc9         1 hcc9          2 dih9</span>
<span class="s2"> h    5 hc10        1 hcc10         9 dih10</span>
<span class="s2"> h    5 hc11        1 hcc11         9 dih11</span>
<span class="s2"> h    6 ho          2 hoc2          1 dih12</span>
<span class="s2"> </span>
<span class="s2">cc2     =    1.500000</span>
<span class="s2">clc3    =    1.790000 </span>
<span class="s2">clcc3   =    109.471</span>
<span class="s2">hc4     =    1.089000</span>
<span class="s2">hcc4    =    109.471</span>
<span class="s2">dih4    =    100.000</span>
<span class="s2">cc5     =    1.500000</span>
<span class="s2">ccc5    =    109.471</span>
<span class="s2">dih5    =   -100.000</span>
<span class="s2">oc6     =    1.430000</span>
<span class="s2">occ6    =    110.600  </span>
<span class="s2">dih6    =    180.000</span>
<span class="s2">hc7     =    1.070000</span>
<span class="s2">hcc7    =    109.471</span>
<span class="s2">dih7    =    120.000</span>
<span class="s2">hc8     =    1.070000</span>
<span class="s2">hcc8    =    109.471</span>
<span class="s2">dih8    =    240.000</span>
<span class="s2">hc9     =    1.070000</span>
<span class="s2">hcc9    =    109.471</span>
<span class="s2">dih9    =    180.000</span>
<span class="s2">hc10    =    1.070000</span>
<span class="s2">hcc10   =    109.471</span>
<span class="s2">dih10   =    120.000</span>
<span class="s2">hc11    =    1.070000</span>
<span class="s2">hcc11   =    109.471</span>
<span class="s2">dih11   =    240.000</span>
<span class="s2">ho      =    0.97       </span>
<span class="s2">hoc2    =    109.471    </span>
<span class="s2">dih12   =    180.0 </span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drawXYZSideBySide_labeled</span><span class="p">(</span><span class="n">chloropropanoate</span><span class="p">,</span> <span class="n">ts_guess</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 3</p>
<p>Include a screenshot of the transition state in your report that you obtained and the corresponding Z-matrix for the transition state guess</p>
</div>
</section>
<section id="constrained-optimization">
<h2><span class="section-number">9.2.2. </span>Constrained optimization<a class="headerlink" href="#constrained-optimization" title="Permalink to this headline">#</a></h2>
<p>We will first optimize our transition state guess keeping the C-Cl distance fixed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts_guess_opt</span> <span class="o">=</span> <span class="n">ts_guess</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">set_output_file</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;poxide.log&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">set_options</span><span class="p">({</span><span class="s2">&quot;frozen_distance&quot;</span><span class="p">:</span><span class="s2">&quot;1 3&quot;</span><span class="p">})</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="s1">&#39;b3pw91/6-31+G*&#39;</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="n">ts_guess_opt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drawXYZSideBySide_labeled</span><span class="p">(</span><span class="n">ts_guess</span><span class="p">,</span> <span class="n">ts_guess_opt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="finding-the-transition-state">
<h2><span class="section-number">9.2.3. </span>Finding the Transition State<a class="headerlink" href="#finding-the-transition-state" title="Permalink to this headline">#</a></h2>
<p>Now that we have our  transition state guess optimized, we want to find out whether this guess is close to the transition state (meaning it has one imaginary frequency) and then optimize to the actual transition state.</p>
<p>If we set <code class="docutils literal notranslate"><span class="pre">full_hess_every</span></code> to <code class="docutils literal notranslate"><span class="pre">0</span></code>, a frequency calculation will be performed at the begining (you could also do it seperately using <code class="docutils literal notranslate"><span class="pre">psi4.frequency([..])</span></code>. By setting <code class="docutils literal notranslate"><span class="pre">opt_type</span></code> to <code class="docutils literal notranslate"><span class="pre">ts</span></code> the optimization will try to find the 1st order saddlepoint that is the transition state.</p>
<p>We will write the normal modes to a file for visualization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">ts_guess_opt</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">clean_options</span><span class="p">()</span>

<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">set_output_file</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ts.log&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">set_options</span><span class="p">({</span>
    <span class="s2">&quot;opt_type&quot;</span><span class="p">:</span><span class="s2">&quot;ts&quot;</span><span class="p">,</span>
    <span class="s2">&quot;geom_maxiter&quot;</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span> 
    <span class="s2">&quot;normal_modes_write&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;full_hess_every&quot;</span><span class="p">:</span><span class="mi">0</span> <span class="c1">#0 compute the initial Hessian only</span>
    <span class="p">})</span>

<span class="n">E</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="s1">&#39;b3pw91/6-31+G*&#39;</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>


<span class="c1">#print out TS in case something goes wrong</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;ts.xyz&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">save_string_xyz_file</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>We can also compare the TS with the guess to see how far we are.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drawXYZSideBySide_labeled</span><span class="p">(</span><span class="n">ts_guess_opt</span><span class="p">,</span> <span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 4</p>
<p>Take a screenshot of the optimised transition state structure. How did the structure change with respect to the constrained-optimised guess?</p>
</div>
<p>We can now have a look at the normal model that we obtained, for that we need to first check how the file is named. Then you can visualize one normal mode at time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check how the file is named, this is a bash command</span>
<span class="c1"># ls means list all the files in the current directory</span>
<span class="c1"># -ltrh are flags that print output as a detailed list (-l) in reversed order(-r) by time (-t) with human readable units (-h)</span>
<span class="o">!</span>ls -lrth ts.*.molden_normal_modes 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># be sure to use the right file in the show_normal_modes</span>
<span class="n">show_normal_modes</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;FILENAME.XX.molden_normal_modes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 4</p>
<p>Report the value of the negative frequency that you obtain.  What motion is this mode related to?
What motions are associated with low and high vibrational frequencies? Choose two positive vibrational modes and desribe their particular associated motion.</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 5</p>
<p>Is the transition state you predicted an early or a late transition state? What about the guess?</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 6</p>
<p>Having found a transition state, how would you now obtain the barrier height for your reaction? Are there ways of verifying whether you have found a meaningful
transition state? <strong>Bonus:</strong> How would you define âmeaningfulâ in
this context?</p>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "psi4"
        },
        kernelOptions: {
            kernelName: "psi4",
            path: "./Exercises/Ex8"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'psi4'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Ex8Theory.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">9.1. </span>Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Backward.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">9.3. </span>Recording a Potential Energy Profile: The Intrinsic Reaction Coordinate (IRC)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Laboratory of Computational Biochemistry and Chemistry  - Prof. Ursula Roethlisberger<br/>
  
    <div class="extra_footer">
      <div class="container-lg mt-3 footer"> <div class="row"> <div class="col-xl-9 d-flex"> <div class="container"> <div class="row"> <div class="col-6 d-flex" style="justify-content:center"> <a href="https://lcbc.epfl.ch"> Laboratory of Computational Biochemistry and Chemistry</a></li>
</div> <div class="col-6 d-flex" style="justify-content:center"> <ul style="list-style:none"> <li> <a href="https://github.com/lcbc-epfl/iesm-public">GitHub </a> </li> </li> <!--<li> <a href="https://doi.org/10.5281/zenodo.0000000"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.00000000.svg" alt="DOI"></a> </li>--> </ul> </div> </div> </div> </div> <div class="col-xl-3"> <a href="https://epfl.ch"><img src="https://www.epfl.ch/wp/5.5/wp-content/themes/wp-theme-2018/assets/svg/epfl-logo.svg?refresh=now" alt="EPFL Logo" style="padding:5px;height:33px;"></a> </div> </div> </div> <div class="row_footer my-3"> Dual licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative Commons Attribution Share Alike 4.0 International</a> (CC BY SA 4.0) and MIT license. (Except where indicated otherwise) </div>
    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>