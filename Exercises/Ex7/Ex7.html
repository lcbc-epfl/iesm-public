
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>8.1. Potential Energy Scans and Visualisation of Trajectories &#8212; Introduction to Electronic Structure Methods</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"ket": ["\\lvert #1 \\rangle", 1], "bra": ["\\langle #1 \\lvert", 1], "Ket": ["\\lvert #1 \\rangle", 1], "Bra": ["\\langle #1 \\lvert", 1], "braket": ["\\langle #1 \\lvert #2 \\rangle", 2], "hop": "\\hat{\\mathcal{H}}", "unit": "\\mathbbm{1}"}}, "tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="9. Finding Transition States and Barrier Heights: First Order Saddle Points" href="../ex8.html" />
    <link rel="prev" title="8. Potential Energy Scans and Visualisation of Trajectories" href="../ex7.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Introduction to Electronic Structure Methods</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Introduction to Electronic Structure Methods
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Exercises
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex1.html">
   1. Linear Algebra in Quantum Mechanics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex1/Ex1Theory.html">
     1.1. Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex1/Ex1Exercises.html">
     1.2. Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex1/Ex1.html">
     1.3. Working with vectors using Numpy
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex2.html">
   2. Hartree-Fock Calculations in
   <em>
    Psi4
   </em>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex2/Ex2.html">
     2.1. Basis Sets - Defining Vector Spaces
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex3.html">
   3. Large Basis Sets, Dissociation Energy and Geometry Optimisation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/Ex3.html">
     3.1. Effects of Basis Set Size: The Molecular Case
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/Ex3Diss.html">
     3.2. Recording a Dissociation Curve for H
     <span class="math notranslate nohighlight">
      \(_2\)
     </span>
     : RHF vs. UHF
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/Ex3GeoOpt.html">
     3.3. Geometry optimization of
     <span class="math notranslate nohighlight">
      \(H_2O\)
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex4b.html">
   4. The hartree fock procedure in detail
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/HF_student.html">
     4.1. Hartree-Fock Procedure for Approximate Quantum Chemistry
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex4.html">
   5. Post-Hartree Fock Methods: MPn and Configuration Interaction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/Ex4Theory.html">
     5.1. MÃ¸ller-Plesset Perturbation Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/BDE.html">
     5.2. Homolytic Cleavage of the C-F Bond
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/HNO3_Correlation.html">
     5.5. Correlation energy
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex5.html">
   6. Density Functional Theory - Comparison with (Post) Hartree-Fock Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex5/Ex5.html">
     6.1. Testing DFT functionals on an aldol reaction.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex5/Ex5b.html">
     6.2. Density Functional Theory 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex6.html">
   7. Troubleshooting, Pitfalls, Traps
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex6/Ex6.html">
     7.1. Fixing errors in the calculations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex6/Ex6_DFT_Hard_Easy.html">
     7.2. Hard and easy cases for DFT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex6/Ex6_DFT_integration_grid.html">
     7.3. Integration grids
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../ex7.html">
   8. Potential Energy Scans and Visualisation of Trajectories
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     8.1. Potential Energy Scans and Visualisation of Trajectories
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex8.html">
   9. Finding Transition States and Barrier Heights: First Order Saddle Points
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex8/Ex8Theory.html">
     9.1. Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex8/Ex8.html">
     9.2. Locating Transition States: Constrained Optimisations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex8/Backward.html">
     9.3. Recording a Potential Energy Profile: The Intrinsic Reaction Coordinate (IRC)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex8/Visualize.html">
     9.5. IRC analysis
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Lecture
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Lecture/CC.html">
   Coupled cluster
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/Exercises/Ex7/Ex7.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/lcbc-epfl/iesm-public"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/lcbc-epfl/iesm-public/issues/new?title=Issue%20on%20page%20%2FExercises/Ex7/Ex7.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        <a class="jupyterhub-button" href="https://noto.epfl.ch/hub/user-redirect/git-pull?repo=https://github.com/lcbc-epfl/iesm-public&urlpath=lab/tree/iesm-public/iesm/Exercises/Ex7/Ex7.ipynb&branch=main"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scanning-a-potential-energy-surface-dihedral-scan-of-butane">
   8.1.1. Scanning a Potential Energy Surface: Dihedral Scan of Butane
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#starting-geometry">
     8.1.1.1. Starting geometry
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rigid-pes-scan">
     8.1.1.2. Rigid PES scan
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualization-of-the-results">
     8.1.1.3. Visualization of the Results
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="potential-energy-scans-and-visualisation-of-trajectories">
<h1><span class="section-number">8.1. </span>Potential Energy Scans and Visualisation of Trajectories<a class="headerlink" href="#potential-energy-scans-and-visualisation-of-trajectories" title="Permalink to this headline">Â¶</a></h1>
<p>The range of problems that can be tackled with Psi4 or other electronic structure packages is not limited
to wavefunction or geometry optimisations. We can use python to create complex inputs, adjusting various settings, or making specific modifications of
some variables.</p>
<p>In this set of exercises, you will instruct Psi4 to
selectively scan one degree of freedom of a potential energy surface.</p>
<div class="section" id="scanning-a-potential-energy-surface-dihedral-scan-of-butane">
<h2><span class="section-number">8.1.1. </span>Scanning a Potential Energy Surface: Dihedral Scan of Butane<a class="headerlink" href="#scanning-a-potential-energy-surface-dihedral-scan-of-butane" title="Permalink to this headline">Â¶</a></h2>
<p>Potential energy surfaces (PES) are complex objects which are, in
general, 3N-6 dimensional, where N is the number of atoms. Therefore, obtaining the complete topology of
a PES is not feasible for most molecules. However, one may limit the
sampling of the surface to a few degrees of freedom that are of interest
and relevant to the problem under examination (<em>cf.</em> figure 1). Scans
along limited degrees of freedom may be helpful if one needs information
about various possible (local) minima, for example if (or whether) one
is trapped in one of them. In practice, the degrees of freedom can be
defined by a Z-matrix, such as the one that you have already been using
in the previous exercises.</p>
<div class="figure align-default" id="pes">
<img alt="../../_images/pesslize.jpg" src="../../_images/pesslize.jpg" />
<p class="caption"><span class="caption-number">Fig. 8.1 </span><span class="caption-text">Example of a 2D PES (right) and a 1D potential energy profile (left)
obtained by considering only one degree of freedom.</span><a class="headerlink" href="#pes" title="Permalink to this image">Â¶</a></p>
</div>
<p>In a <em>relaxed PES scan</em>, all degrees of freedom that are not under
consideration are optimised, and one obtains a minimum energy path along
the chosen degree(s) of freedom. This implies that a constrained
optimisation is carried out for each desired value of the degree of
freedom that is being sampled.
Instead, one may freeze the remaining degrees of
freedom, keeping them fixed at their initial values, lowering the computational cost. This procedure is
referred to as a <em>rigid PES scan</em>. For simple scans of bond angles or
lengths in a pre-optimised structure, this is often sufficient (and more
efficient).</p>
<p>In this exercise, you will perform a relaxed potential energy
scan of the dihedral in butane in order to determine the possible
configurational minima, and the rotational barrier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">psi4</span>
<span class="kn">import</span> <span class="nn">py3Dmol</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi4</span><span class="o">.</span><span class="n">set_num_threads</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">set_memory</span><span class="p">(</span><span class="s1">&#39;2 GB&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000000000
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Threads set to 2 by Python driver.

  Memory set to   1.863 GiB by Python driver.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">helpers</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="starting-geometry">
<h3><span class="section-number">8.1.1.1. </span>Starting geometry<a class="headerlink" href="#starting-geometry" title="Permalink to this headline">Â¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">butane</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">C       </span>
<span class="s2">C    1    1.450000</span>
<span class="s2">C    1    1.450000      2  109.471000</span>
<span class="s2">H    1 1.089         2 109.471000         3 120</span>
<span class="s2">H    1 1.089        2 109.471000          3 -120</span>
<span class="s2">C    2 1.45         1 109.471000         3 180</span>
<span class="s2">H    2 1.089        1 109.471000        6 120</span>
<span class="s2">H    2 1.089         1 109.471000          6 240</span>
<span class="s2">H    3 1.089         1 109.471000          2 180</span>
<span class="s2">H    3 1.089        1 109.471000         9 120</span>
<span class="s2">H    3 1.089        1 109.471000         9 240</span>
<span class="s2">H    6 1.089        2 109.471000         1 180</span>
<span class="s2">H    6 1.089       2 109.471000        12 120</span>
<span class="s2">H    6 1.089        2 109.471000        12 240</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drawXYZ_labeled</span><span class="p">(</span><span class="n">butane</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div id="3dmolviewer_16312694809216015"  style="position: relative; width: 400px; height: 400px">
        <p id="3dmolwarning_16312694809216015" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
      resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://3dmol.org/build/3Dmol.js');
}

var viewer_16312694809216015 = null;
var warn = document.getElementById("3dmolwarning_16312694809216015");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_16312694809216015 = $3Dmol.createViewer($("#3dmolviewer_16312694809216015"),{backgroundColor:"white"});
viewer_16312694809216015.zoomTo();
	viewer_16312694809216015.addModel("14\n\n C    0.000000000000    0.725000000000    0.000000000000\n C    0.000000000000   -0.725000000000    0.000000000000\n C   -1.367074971503    1.208328069007    0.000000000000\n H    0.513360222058    1.087996046309    0.889165987188\n H    0.513360222058    1.087996046309   -0.889165987188\n C    1.367074971503   -1.208328069007    0.000000000000\n H   -0.513360222058   -1.087996046309    0.889165987188\n H   -0.513360222058   -1.087996046309   -0.889165987188\n H   -1.367074971503    2.297328069007    0.000000000000\n H   -1.880429602190    0.845324115338   -0.889165987188\n H   -1.880429602190    0.845324115338    0.889165987188\n H    1.367074971503   -2.297328069007    0.000000000000\n H    1.880429602190   -0.845324115338   -0.889165987188\n H    1.880429602190   -0.845324115338    0.889165987188\n","xyz");
	viewer_16312694809216015.addLabel("0",{"position": {"x": 0.0, "y": 0.7250000000016578, "z": 0.0}, "inFront": true});
	viewer_16312694809216015.addLabel("1",{"position": {"x": 0.0, "y": -0.7250000000016578, "z": 0.0}, "inFront": true});
	viewer_16312694809216015.addLabel("2",{"position": {"x": -1.367074971506163, "y": 1.2083280690096956, "z": 0.0}, "inFront": true});
	viewer_16312694809216015.addLabel("3",{"position": {"x": 0.5133602220586935, "y": 1.087996046311832, "z": 0.8891659871904984}, "inFront": true});
	viewer_16312694809216015.addLabel("4",{"position": {"x": 0.5133602220586935, "y": 1.087996046311832, "z": -0.8891659871904984}, "inFront": true});
	viewer_16312694809216015.addLabel("5",{"position": {"x": 1.367074971506163, "y": -1.2083280690096956, "z": 0.0}, "inFront": true});
	viewer_16312694809216015.addLabel("6",{"position": {"x": -0.5133602220586935, "y": -1.087996046311832, "z": 0.8891659871904984}, "inFront": true});
	viewer_16312694809216015.addLabel("7",{"position": {"x": -0.5133602220586935, "y": -1.087996046311832, "z": -0.8891659871904984}, "inFront": true});
	viewer_16312694809216015.addLabel("8",{"position": {"x": -1.367074971506163, "y": 2.297328069012185, "z": 0.0}, "inFront": true});
	viewer_16312694809216015.addLabel("9",{"position": {"x": -1.8804296021942979, "y": 0.845324115339741, "z": -0.8891659871904983}, "inFront": true});
	viewer_16312694809216015.addLabel("10",{"position": {"x": -1.8804296021942979, "y": 0.845324115339741, "z": 0.8891659871904984}, "inFront": true});
	viewer_16312694809216015.addLabel("11",{"position": {"x": 1.367074971506163, "y": -2.297328069012185, "z": 0.0}, "inFront": true});
	viewer_16312694809216015.addLabel("12",{"position": {"x": 1.8804296021942979, "y": -0.845324115339741, "z": -0.8891659871904984}, "inFront": true});
	viewer_16312694809216015.addLabel("13",{"position": {"x": 1.880429602194298, "y": -0.845324115339741, "z": 0.8891659871904983}, "inFront": true});
	viewer_16312694809216015.setStyle({"stick": {}, "sphere": {"scale": 0.1}});
	viewer_16312694809216015.setStyle({"model": 0},{"stick": {"colorscheme": "yellowCarbon"}, "sphere": {"scale": 0.1}});
	viewer_16312694809216015.zoomTo();
viewer_16312694809216015.render();
});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drawXYZ</span><span class="p">(</span><span class="n">butane</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div id="3dmolviewer_16312694819803686"  style="position: relative; width: 400px; height: 400px">
        <p id="3dmolwarning_16312694819803686" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
      resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://3dmol.org/build/3Dmol.js');
}

var viewer_16312694819803686 = null;
var warn = document.getElementById("3dmolwarning_16312694819803686");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_16312694819803686 = $3Dmol.createViewer($("#3dmolviewer_16312694819803686"),{backgroundColor:"white"});
viewer_16312694819803686.zoomTo();
	viewer_16312694819803686.addModel("14\n\n C    0.000000000000    0.725000000000    0.000000000000\n C    0.000000000000   -0.725000000000    0.000000000000\n C   -1.367074971503    1.208328069007    0.000000000000\n H    0.513360222058    1.087996046309    0.889165987188\n H    0.513360222058    1.087996046309   -0.889165987188\n C    1.367074971503   -1.208328069007    0.000000000000\n H   -0.513360222058   -1.087996046309    0.889165987188\n H   -0.513360222058   -1.087996046309   -0.889165987188\n H   -1.367074971503    2.297328069007    0.000000000000\n H   -1.880429602190    0.845324115338   -0.889165987188\n H   -1.880429602190    0.845324115338    0.889165987188\n H    1.367074971503   -2.297328069007    0.000000000000\n H    1.880429602190   -0.845324115338   -0.889165987188\n H    1.880429602190   -0.845324115338    0.889165987188\n","xyz");
	viewer_16312694819803686.setStyle({"stick": {}, "sphere": {"scale": 0.1}});
	viewer_16312694819803686.zoomTo();
viewer_16312694819803686.render();
});
</script></div></div>
</div>
</div>
<div class="section" id="rigid-pes-scan">
<h3><span class="section-number">8.1.1.2. </span>Rigid PES scan<a class="headerlink" href="#rigid-pes-scan" title="Permalink to this headline">Â¶</a></h3>
<p>Now that we had a look at the butane molecule, letâs perform the rigid PES scan. We will fix the dihedral angle at different values and do single point calculations.
First, we need to optimize the the geometry provided above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">clean_options</span><span class="p">()</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">clean_variables</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#First optimize the butane molecule </span>
<span class="c1">#from the starting geometry provided</span>
<span class="c1">#use the bylp method and the 6-31+G* basis set</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dihedrals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">72</span><span class="p">)</span> <span class="c1">#We set here the dihedrals that we are going to use for the scan</span>
<span class="n">PES</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1">#Here we will store the optimized energy for each dihedral. This is a dictionary</span>
<span class="n">geometries</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#Here we will store the optimized geometries. This is a list</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">butane</span><span class="o">.</span><span class="n">print_in_input_format</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The geometry optimization will print you the optimized coordinates in the format you provided them at the end if you call <code class="docutils literal notranslate"><span class="pre">butane.print_in_input_format()</span></code>. Here, this is the z-matrix format. Use these coordinates below and create a python f-string where you replace the dihedral that we want to scan with a variable.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">dihedral</span> <span class="ow">in</span> <span class="n">dihedrals</span><span class="p">:</span>
    <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    x i bond k angle j </span><span class="si">{</span><span class="n">dihedral</span><span class="si">}</span><span class="s2"> #this is the dihedral we want to optimize</span>
<span class="s2">    x i bond k angle j dihedral</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
    <span class="p">[</span><span class="o">....</span><span class="p">]</span>
</pre></div>
</div>
<p>Save the molecules in the <code class="docutils literal notranslate"><span class="pre">geometries</span></code> list (use <code class="docutils literal notranslate"><span class="pre">butane.clone()</span></code>) and save the calculated energies in the <code class="docutils literal notranslate"><span class="pre">PES</span></code> dictionary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Convert the energy units to kcal/mol</span>
<span class="c1">#you can use psi4.constants.hartree2kcalmol for the unit conversion </span>
<span class="c1"># in python you can use list comprehensions e.g [x+1 for x in lst] will increase every value in lst by 1.</span>
<span class="c1"># to access the values in the dictionary PES you can use PES.values() which return a list.</span>
<span class="n">energies</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1">#Rescale the energy scale by setting the minimum value as the zero of the scale</span>
<span class="c1">#and change everything accordingly</span>
<span class="c1"># the function np.min(lst) returns the lowest value of a list. </span>
<span class="c1"># to use broadcasting you need to convert the list into a np.array by calling np.array(energies)</span>
<span class="n">energies</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="visualization-of-the-results">
<h3><span class="section-number">8.1.1.3. </span>Visualization of the Results<a class="headerlink" href="#visualization-of-the-results" title="Permalink to this headline">Â¶</a></h3>
<p>Now, letâs plot the PES at the different dihedral considered. You can use a little helper function which will read in the optimized geometries just calculated and the dihedrals and return the PES and the corresponding geometry at each dihedral value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span> <span class="o">=</span> <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">save_string_xyz_file</span><span class="p">()</span> <span class="k">for</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">geometries</span><span class="p">]</span>
<span class="n">traj_arrays</span> <span class="o">=</span> <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">to_arrays</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">geometries</span><span class="p">]</span>

<span class="n">drawXYZGeomSliderMolecularProperty</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dihedrals</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="s1">&#39;dihedral&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we can monitor different quantities during the rigid PES scan, to understand how the different dihedrals affect the overall geometry. One example is the bond length between C atoms 1 and 2, the central atoms of the dihedral for which we performed the scan. Having a look at the fluctuations of this bond legth during the scan can be easily done using one of the helper functions, which will read the coordinates of the two atoms and calculate their distance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bond_length</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">traj_arrays</span><span class="p">:</span>
    <span class="n">bond_length</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">calculate_bond</span><span class="p">(</span><span class="n">geom</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">geom</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="c1">#Here the bond length is calculated and saved</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dihedrals</span><span class="p">,</span> <span class="n">bond_length</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;dihedral&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;bond [A]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 1</p>
<p>Does the bond length of the <span class="math notranslate nohighlight">\(H_3CH_2C-CH_2CH_3\)</span> bond fluctuate as
the dihedral is changed? Why (not)?</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 2</p>
<p>Create a potential energy profile along the dihedral by plotting the
energies of the system as a function of the scanned dihedral angle as done above.
Then, to each maximum and minimum, assign the corresponding
conformation from your trajectory. Show these conformations in your
report.
Assign also names to the conformations according to the <em>Newman
projections</em> you know from organic chemistry (where possible).</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 3</p>
<p>The rotational barrier of butane lies between 5 and 6 kcal  mol<span class="math notranslate nohighlight">\(^{-1}\)</span> <span id="id1"><sup><a class="reference internal" href="../../intro.html#id5">7</a></sup></span>. Compare this value with the one you calculated and explain possible sources of error, leading to higher or lower barriers.</p>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "psi4"
        },
        kernelOptions: {
            kernelName: "psi4",
            path: "./Exercises/Ex7"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'psi4'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="../ex7.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title"><span class="section-number">8. </span>Potential Energy Scans and Visualisation of Trajectories</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="../ex8.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title"><span class="section-number">9. </span>Finding Transition States and Barrier Heights: First Order Saddle Points</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Laboratory of Computational Biochemistry and Chemistry  - Prof. Ursula Roethlisberger<br/>
        
          <div class="extra_footer">
            <div class="container-lg mt-3 footer"> <div class="row"> <div class="col-xl-9 d-flex"> <div class="container"> <div class="row"> <div class="col-6 d-flex" style="justify-content:center"> <a href="https://lcbc.epfl.ch"> Laboratory of Computational Biochemistry and Chemistry</a></li>
</div> <div class="col-6 d-flex" style="justify-content:center"> <ul style="list-style:none"> <li> <a href="https://github.com/lcbc-epfl/iesm-public">GitHub </a> </li> </li> <!--<li> <a href="https://doi.org/10.5281/zenodo.0000000"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.00000000.svg" alt="DOI"></a> </li>--> </ul> </div> </div> </div> </div> <div class="col-xl-3"> <a href="https://epfl.ch"><img src="https://www.epfl.ch/wp/5.5/wp-content/themes/wp-theme-2018/assets/svg/epfl-logo.svg?refresh=now" alt="EPFL Logo" style="padding:5px;height:33px;"></a> </div> </div> </div> <div class="row_footer my-3"> Dual licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative Commons Attribution Share Alike 4.0 International</a> (CC BY SA 4.0) and MIT license. (Except where indicated otherwise) </div>
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>