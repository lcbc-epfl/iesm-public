
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>7.2. Hard and easy cases for DFT &#8212; Introduction to Electronic Structure Methods</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"TeX": {"Macros": {"ket": ["\\lvert #1 \\rangle", 1], "bra": ["\\langle #1 \\lvert", 1], "Ket": ["\\lvert #1 \\rangle", 1], "Bra": ["\\langle #1 \\lvert", 1], "braket": ["\\langle #1 \\lvert #2 \\rangle", 2], "hop": "\\hat{\\mathcal{H}}", "unit": "\\mathbbm{1}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Exercises/Ex7/Ex7_DFT_Hard_Easy';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="7.3. Integration grids" href="Ex7_DFT_integration_grid.html" />
    <link rel="prev" title="7.1. Fixing errors in the calculations" href="Ex7_errors.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Introduction to Electronic Structure Methods</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Introduction to Electronic Structure Methods
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Exercises</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex1/IESM_Ex1.html">1. Linear Algebra in Quantum Mechanics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex1/Ex1_LinearAlgebra.html">1.1. Review of Linear Algebra Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex1/Ex1_QM.html">1.2. Basic Concepts in Quantum Mechanics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex1/Ex1_Numpy.html">1.3. Working with vectors using Numpy</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex2/IESM_Ex2.html">2. First steps in <em>Psi4</em></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex2/Ex2_theory.html">2.1. Basis Sets - Defining Vector Spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex2/Ex2_hydrogen_atom.html">2.2. The Hydrogen Atom</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex2/Ex2_water-molecule.html">2.3. A more complex system: H<span class="math notranslate nohighlight">\(_{2}\)</span>O</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex3/IESM_Ex3.html">3. Large Basis Sets, Dissociation Energy and Geometry Optimisation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/Ex3_H2molecule.html">3.1. Effects of Basis Set Size: The Molecular Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/Ex3_Dissociation.html">3.2. Recording a Dissociation Curve for H<span class="math notranslate nohighlight">\(_2\)</span>: RHF vs. UHF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/Ex3_GeometryOpt.html">3.3. Geometry optimization of <span class="math notranslate nohighlight">\(H_2O\)</span></a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex4/IESM_Ex4b.html">4. The hartree fock procedure in detail</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex4/HF.html">4.1. Hartree-Fock Procedure for Approximate Quantum Chemistry</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex5/IESM_Ex5.html">5. Post-Hartree Fock Methods: CI and MPn</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex5/Ex5Theory.html">5.1. Post-Hartree Fock Methods: Theory Recap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex5/Ex5_Boron.html">5.2. Recovering Correlation Energy: B atom</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex5/Ex5_BDE.html">5.3. Homolytic Cleavage of the C-F Bond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex5/Ex5_HNO3.html">5.4. Influence of correlation on geometry: HNO<span class="math notranslate nohighlight">\(_3\)</span> molecule</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex6/IESM_Ex6.html">6. DFT vs (Post) HF Methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex6/Ex6_aval.html">6.1. Methylcyclohexane A-value</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex6/Ex6_geo.html">6.2. Geometric properties:  NO<span class="math notranslate nohighlight">\(_3\cdot\)</span> radical</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="IESM_Ex7.html">7. Troubleshooting, Pitfalls, Traps</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Ex7_errors.html">7.1. Fixing errors in the calculations</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">7.2. Hard and easy cases for DFT</a></li>
<li class="toctree-l2"><a class="reference internal" href="Ex7_DFT_integration_grid.html">7.3. Integration grids</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex9/IESM_Ex9.html">8. Finding Transition States and Barrier Heights: First Order Saddle Points</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex9/Ex9Theory.html">8.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex9/Ex9.html">8.2. Locating Transition States: Constrained Optimisations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex9/Backward.html">8.3. Recording a Potential Energy Profile: The Intrinsic Reaction Coordinate (IRC)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Ex9/Visualize.html">8.5. IRC analysis</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex8/IESM_Ex8.html">9. Potential Energy Scans and Visualisation of Trajectories</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex8/Ex8.html">9.1. Potential Energy Scans and Visualisation of Trajectories</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Lecture/BasisFunctions.html">Basis functions in quantum chemistry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Lecture/CC.html">Coupled cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Lecture/FAQ.html">FAQ</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://noto.epfl.ch/hub/user-redirect/git-pull?repo=https%3A//github.com/lcbc-epfl/iesm-public&urlpath=lab/tree/iesm-public/iesm/Exercises/Ex7/Ex7_DFT_Hard_Easy.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/lcbc-epfl/iesm-public" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/lcbc-epfl/iesm-public/issues/new?title=Issue%20on%20page%20%2FExercises/Ex7/Ex7_DFT_Hard_Easy.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Exercises/Ex7/Ex7_DFT_Hard_Easy.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Hard and easy cases for DFT</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dispersion-correction">7.2.1. Dispersion correction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accuracy-of-dft-swiss-army-knife-for-computational-chemistry">7.2.2. Accuracy of DFT: Swiss army knife for computational chemistry?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bde-cao-into-atomic-calcium-and-oxygen">7.2.3. BDE CaO into atomic calcium and oxygen</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interaction-of-two-ethane-molecules">7.2.4. Interaction of two Ethane molecules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eclipsed-staggered-methanol">7.2.5. Eclipsed/Staggered Methanol</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="hard-and-easy-cases-for-dft">
<h1><span class="section-number">7.2. </span>Hard and easy cases for DFT<a class="headerlink" href="#hard-and-easy-cases-for-dft" title="Link to this heading">#</a></h1>
<section id="dispersion-correction">
<h2><span class="section-number">7.2.1. </span>Dispersion correction<a class="headerlink" href="#dispersion-correction" title="Link to this heading">#</a></h2>
<p>Dispersion interactions are caused by long-range electron correlation  and decay asymptotically with
<span class="math notranslate nohighlight">\(E_{\text{disp}} \propto - C_6/R^6\)</span> (London interaction). As the distance between two electron clouds is reduced this dispersion interaction becomes part of the normal correlation energy for short e-e distances. The London part of the dispersion energy is not included in standard local density functionals. The inclusion of short/medium range dispersion depends on the functional. Semi-local functionals that include the gradient of the density or the kinetic energy density tend to do better in this regard. A proper description of dispersion requires non-local correlation functionals.</p>
<p>Dispersion is often synomously used with Van der Waals interaction, but technically this is not correct. Dispersion is a time-independent phenomen that one can observe e.g. for  non-overlapping, spherically-symmetric charge densities (e.g two argon atoms A and B at points <span class="math notranslate nohighlight">\(\vec{r}\)</span> and <span class="math notranslate nohighlight">\(\vec{r}'\)</span>). The dispersion interaction shows up as large density gradient in regions of space where the density itself is small.</p>
<p>This can be better described by newer exchange-correlation potentials having the following form</p>
<div class="math notranslate nohighlight">
\[
v_c^{\text{nl}}(\vec{r}) = \int f(\vec{r}, \vec{r}') dr'
\]</div>
<p>where a perturbation at <span class="math notranslate nohighlight">\(\vec{r}'\)</span> due to atom B, induces an exchange-correlation potential at <span class="math notranslate nohighlight">\(\vec{r}\)</span> on atom A, even at a great distance.
Examples for such functionals are <code class="docutils literal notranslate"><span class="pre">VV10</span></code> and <code class="docutils literal notranslate"><span class="pre">vdW-DF-10</span></code>.</p>
<p>A cheaper and simple solution is to use an empirical potential of the form <span class="math notranslate nohighlight">\(- C_6/R^6\)</span>.
A popular dispersion correction is DFT-D3 by Grimme and coworkers. Like other corrections of the DFT-D family, this is an additive correction.</p>
<div class="math notranslate nohighlight">
\[E_{\text{B3LYP-D3}} = E_{\text{B3LYP}} + E_{\text{D3, 2-body}} + E_{\text{ATM, 3-body}}\]</div>
<p>The dispersion correction consists of a two-body term plus a three-body term of the Axilrod-Teller-Muto (ATM) triple-dipole variety. If the BJ approach is used, a slightly different damping function is employed to make the potential finite (but non-zero) for <span class="math notranslate nohighlight">\(R_{AB} \rightarrow 0\)</span>. This is the preferred dispersion correction for most uses.</p>
<p>In Psi4 we can also add non-local density based correlation energy from the VV10 functional to e.g the b3lyp functional by using the following keyword <code class="docutils literal notranslate"><span class="pre">b3lyp-nl</span></code>.  The VV10 functional is less empirical than the DFT-D approaches, as it contains only two fitted parameters.</p>
</section>
<section id="accuracy-of-dft-swiss-army-knife-for-computational-chemistry">
<h2><span class="section-number">7.2.2. </span>Accuracy of DFT: Swiss army knife for computational chemistry?<a class="headerlink" href="#accuracy-of-dft-swiss-army-knife-for-computational-chemistry" title="Link to this heading">#</a></h2>
<p>DFT although fast and available in many quantum chemistry programs is not a universal solution for any system. In principle, DFT is exact. However, in practice, as we rely on density functional approximations (DFA), the results can vary widely, depending on the DFA used. DFA are often fit using reference data from databases containing atomization energies and various other data. In this example, we will look at three reactions using geometries obtained from quantum chemical reference datasets. For reasons of efficiency, we will only perform single point calculations using a variety of functionals to learn about some points that we need to be careful about when using DFT.</p>
<p>The reactions of interest are:</p>
<ol class="arabic simple">
<li><p>Homolytic bond dissociation energy of CaO into atomic calcium and oxygen (taken from Minnesota 2015B database, 96.15 kcal mol<span class="math notranslate nohighlight">\(^{-1}\)</span>)</p></li>
<li><p>Interaction energy of two ethane molecules (taken from GMTKN55 database, -1.34 kcal mol<span class="math notranslate nohighlight">\(^{-1}\)</span>)</p></li>
<li><p>Energy difference between the staggered and eclipsed methanol conformations (taken from GMTKN55 database, -1.01 kcal mol<span class="math notranslate nohighlight">\(^{-1}\)</span>)</p></li>
</ol>
<p>Note, that one of the reactions is contained in the training data of one of the functionals that we will be using.<br />
These exercises are based on Pierpaolo Morgante and Roberto Peverati’s 2020 Review: (<a class="reference external" href="https://doi.org/10.1002/qua.26332">https://doi.org/10.1002/qua.26332</a>).</p>
<div class="exercise admonition">
<p class="admonition-title">Exercise 5</p>
<p>Before running the calculations, give your best estimate as to which of the reaction energies (i.e. the energy difference between product and reactants) do you think is most “difficult” to calculate? Rank them in order of increasing difficulty and explain the reasoning behind your choices.</p>
<p>Difficult in this case refers to getting an accurate reaction energy with low absolute error to true energy (reference energy from the dataset). As chemical accuracy we usually use 1 kcal mol<span class="math notranslate nohighlight">\(^-1\)</span></p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 6</p>
<p>Run the calculations below and check whether your assessment of the hard, medium and easy reactions is correct. Include the tables containing the calculated energies for the three problems in your report. Which functional do you think contained the reaction in its training data?</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Bonus Exercise 7</p>
<p>How could fortitous error cancellation help in getting good results when calculating reaction energies?</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 8</p>
<p>What is the impact of using the dispersion correction for the ethane complex? For what phenomena are such corrections relevant? Give a real world example system.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">psi4</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>


<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">helpers</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi4</span><span class="o">.</span><span class="n">set_num_threads</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">set_memory</span><span class="p">(</span><span class="s1">&#39;2 GB&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Threads set to 2 by Python driver.

  Memory set to   1.863 GiB by Python driver.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000000000
</pre></div>
</div>
</div>
</div>
</section>
<section id="bde-cao-into-atomic-calcium-and-oxygen">
<h2><span class="section-number">7.2.3. </span>BDE CaO into atomic calcium and oxygen<a class="headerlink" href="#bde-cao-into-atomic-calcium-and-oxygen" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cao</span><span class="o">=</span><span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">0 1</span>
<span class="s2">Ca 0.0000000 0.0000000 1.8210000</span>
<span class="s2">O 0.0000000 0.0000000 0.0000000</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ca</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">0 1</span>
<span class="s2">Ca   0.0   0.0   0.0</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">o</span><span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">0 3</span>
<span class="s2">O   0.0   0.0   0.0</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">methods</span> <span class="o">=</span><span class="p">[</span> <span class="s1">&#39;pbe&#39;</span><span class="p">,</span> <span class="s1">&#39;b3lyp&#39;</span><span class="p">,</span> <span class="s1">&#39;mn15&#39;</span><span class="p">,</span><span class="s1">&#39;mp2&#39;</span><span class="p">,</span> <span class="s1">&#39;scan&#39;</span><span class="p">]</span> <span class="c1">#These are the methods that we are going to use</span>
<span class="n">energies</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1">#Here we will store the energies</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">set_output_file</span><span class="p">(</span><span class="s1">&#39;dft_cao.log&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
    <span class="c1"># we clone all the molecules as we want to start the geometry optimization from the same starting structure</span>
    <span class="n">cao_opt</span> <span class="o">=</span> <span class="n">cao</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">ca_opt</span> <span class="o">=</span> <span class="n">ca</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">o_opt</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

    <span class="c1"># call psi4  single point energy calculation once per method</span>
    <span class="c1"># use def2-QZVP basis set    </span>
    <span class="n">psi4</span><span class="o">.</span><span class="n">set_options</span><span class="p">({</span><span class="s1">&#39;dft_radial_points&#39;</span><span class="p">:</span><span class="mi">99</span><span class="p">,</span> <span class="s1">&#39;dft_spherical_points&#39;</span><span class="p">:</span> <span class="mi">590</span><span class="p">,</span> <span class="s1">&#39;reference&#39;</span><span class="p">:</span><span class="s1">&#39;uks&#39;</span><span class="p">})</span>
    <span class="n">E_cao</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">E_o</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">E_ca</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># calculate the raction energy in kcal/mol </span>
    <span class="c1"># you can use psi4.constants.hartree2kcalmol for the unit conversion    </span>
    <span class="n">E_reaction</span> <span class="o">=</span> <span class="kc">None</span> 

    <span class="n">energies</span><span class="p">[</span><span class="n">method</span><span class="p">]</span><span class="o">=</span> <span class="p">[</span><span class="n">E_cao</span><span class="p">,</span> <span class="n">E_o</span><span class="p">,</span> <span class="n">E_ca</span><span class="p">,</span> <span class="n">E_reaction</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># insert the reference here</span>
<span class="n">energies</span><span class="p">[</span><span class="s1">&#39;reference&#39;</span><span class="p">]</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mf">96.15</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">energies</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E_CaO&#39;</span><span class="p">,</span> <span class="s1">&#39;E_O&#39;</span><span class="p">,</span> <span class="s1">&#39;E_Ca&#39;</span><span class="p">,</span> <span class="s1">&#39;E_reaction (kcal/mol)&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>E_CaO</th>
      <th>E_O</th>
      <th>E_Ca</th>
      <th>E_reaction (kcal/mol)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pbe</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b3lyp</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mn15</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mp2</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>scan</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>reference</th>
      <td></td>
      <td></td>
      <td></td>
      <td>96.15</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">clean_options</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="interaction-of-two-ethane-molecules">
<h2><span class="section-number">7.2.4. </span>Interaction of two Ethane molecules<a class="headerlink" href="#interaction-of-two-ethane-molecules" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dimer</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">symmetry c1</span>
<span class="s2">0 1</span>
<span class="s2">C  0.684160244353  0.337751120631  -1.9114826827</span>
<span class="s2">C  -0.684160244353  -0.337751120631  -1.9114826827</span>
<span class="s2">H  1.48964553204  -0.401434143375  -1.9114826827</span>
<span class="s2">H  0.812773290289  0.969660346322  -2.794291998</span>
<span class="s2">H  0.812773290289  0.969660346322  -1.0286733674</span>
<span class="s2">H  -1.48964553204  0.401434143375  -1.9114826827</span>
<span class="s2">H  -0.812773290289  -0.969660346322  -2.794291998</span>
<span class="s2">H  -0.812773290289  -0.969660346322  -1.0286733674</span>
<span class="s2">C  0.684160244353  -0.337751120631  1.9114826827</span>
<span class="s2">C  -0.684160244353  0.337751120631  1.9114826827</span>
<span class="s2">H  1.48964553204  0.401434143375  1.9114826827</span>
<span class="s2">H  0.812773290289  -0.969660346322  2.794291998</span>
<span class="s2">H  0.812773290289  -0.969660346322  1.0286733674</span>
<span class="s2">H  -1.48964553204  -0.401434143375  1.9114826827</span>
<span class="s2">H  -0.812773290289  0.969660346322  2.794291998</span>
<span class="s2">H  -0.812773290289  0.969660346322  1.0286733674</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">monomer</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">symmetry c1</span>
<span class="s2">0 1</span>
<span class="s2">C  0.0  0.0  0.762988243308</span>
<span class="s2">C  0.0  0.0  -0.762988243308</span>
<span class="s2">H  -0.882809099823  0.509690071426  1.1580401983</span>
<span class="s2">H  0.0  -1.01938014285  1.1580401983</span>
<span class="s2">H  0.882809099823  0.509690071426  1.1580401983</span>
<span class="s2">H  0.882809099823  -0.509690071426  -1.1580401983</span>
<span class="s2">H  -0.882809099823  -0.509690071426  -1.1580401983</span>
<span class="s2">H  0.0  1.01938014285  -1.1580401983</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drawXYZSideBySide</span><span class="p">(</span><span class="n">monomer</span><span class="p">,</span> <span class="n">dimer</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div id="3dmolviewer_17020219422485862"  style="position: relative; width: 640px; height: 480px;">
        <p id="3dmolwarning_17020219422485862" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.0.3/3Dmol-min.js');
}

var viewer_17020219422485862 = null;
var warn = document.getElementById("3dmolwarning_17020219422485862");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
var viewergrid_17020219422485862 = null;
viewergrid_17020219422485862 = $3Dmol.createViewerGrid(document.getElementById("3dmolviewer_17020219422485862"),{rows: 1, cols: 2, control_all: true},{backgroundColor:"white"});
viewer_17020219422485862 = viewergrid_17020219422485862[0][0];
viewergrid_17020219422485862[0][0].zoomTo();viewergrid_17020219422485862[0][1].zoomTo();	viewergrid_17020219422485862[0][0].addModel("8\n\n C    0.000000000000    0.762988243308    0.000000000000\n C    0.000000000000   -0.762988243308    0.000000000000\n H    0.509690071425    1.158040198300    0.882809099823\n H    0.509690071425    1.158040198300   -0.882809099821\n H   -1.019380142852    1.158040198300   -0.000000000000\n H   -0.509690071425   -1.158040198300   -0.882809099823\n H    1.019380142852   -1.158040198300    0.000000000000\n H   -0.509690071425   -1.158040198300    0.882809099821\n","xyz");
	viewergrid_17020219422485862[0][1].addModel("16\n\n C    0.684160244353    0.337751120631   -1.911482682700\n C   -0.684160244353   -0.337751120631   -1.911482682700\n H    1.489645532040   -0.401434143375   -1.911482682700\n H    0.812773290289    0.969660346322   -2.794291998000\n H    0.812773290289    0.969660346322   -1.028673367400\n H   -1.489645532040    0.401434143375   -1.911482682700\n H   -0.812773290289   -0.969660346322   -2.794291998000\n H   -0.812773290289   -0.969660346322   -1.028673367400\n C    0.684160244353   -0.337751120631    1.911482682700\n C   -0.684160244353    0.337751120631    1.911482682700\n H    1.489645532040    0.401434143375    1.911482682700\n H    0.812773290289   -0.969660346322    2.794291998000\n H    0.812773290289   -0.969660346322    1.028673367400\n H   -1.489645532040   -0.401434143375    1.911482682700\n H   -0.812773290289    0.969660346322    2.794291998000\n H   -0.812773290289    0.969660346322    1.028673367400\n","xyz");
	viewergrid_17020219422485862[0][0].setStyle({"stick": {}, "sphere": {"scale": 0.1}});
	viewergrid_17020219422485862[0][1].setStyle({"stick": {}, "sphere": {"scale": 0.1}});
	viewergrid_17020219422485862[0][0].zoomTo();
	viewergrid_17020219422485862[0][1].zoomTo();
viewergrid_17020219422485862[0][1].render();
viewergrid_17020219422485862[0][0].render();
});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b3lyp&#39;</span><span class="p">,</span> <span class="s1">&#39;b3lyp-d3(bj)&#39;</span><span class="p">,</span> <span class="s1">&#39;b3lyp-nl&#39;</span> <span class="p">,</span><span class="s1">&#39;pbe&#39;</span><span class="p">,</span> <span class="s1">&#39;pbe-d3&#39;</span><span class="p">,</span> <span class="s1">&#39;mp2&#39;</span><span class="p">,</span> <span class="s1">&#39;svwn&#39;</span><span class="p">]</span> <span class="c1">#These are the methods that we are going to compare</span>
<span class="n">energies</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1">#Here we will store the energies</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">set_output_file</span><span class="p">(</span><span class="s1">&#39;dft_ethane.log&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
    <span class="c1"># we clone all the molecules as we want to start the geometry optimization from the same starting structure</span>
    <span class="n">monomer_opt</span> <span class="o">=</span> <span class="n">monomer</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">dimer_opt</span> <span class="o">=</span> <span class="n">dimer</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

    <span class="c1"># call psi4  single point energy calculation once per method</span>
    <span class="c1"># use def2-TZVP basis set</span>
    <span class="n">E_monomer</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">E_dimer</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># calculate the raction energy in kcal/mol </span>
    <span class="c1"># you can use psi4.constants.hartree2kcalmol for the unit conversion    </span>
    <span class="n">E_reaction</span> <span class="o">=</span> <span class="kc">None</span>
    
    <span class="n">energies</span><span class="p">[</span><span class="n">method</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">E_dimer</span><span class="p">,</span> <span class="n">E_monomer</span><span class="p">,</span> <span class="n">E_reaction</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># insert the reference here</span>
<span class="n">energies</span><span class="p">[</span><span class="s1">&#39;reference&#39;</span><span class="p">]</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.34</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">energies</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E_dimer&#39;</span><span class="p">,</span> <span class="s1">&#39;E_monomer&#39;</span><span class="p">,</span> <span class="s1">&#39;E_interaction (kcal/mol)&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>E_dimer</th>
      <th>E_monomer</th>
      <th>E_interaction (kcal/mol)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b3lyp</th>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b3lyp-d3(bj)</th>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b3lyp-nl</th>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>pbe</th>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>pbe-d3</th>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mp2</th>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>svwn</th>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>reference</th>
      <td></td>
      <td></td>
      <td>-1.34</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">clean_options</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="eclipsed-staggered-methanol">
<h2><span class="section-number">7.2.5. </span>Eclipsed/Staggered Methanol<a class="headerlink" href="#eclipsed-staggered-methanol" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">methanol_eclipsed</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">0 1</span>
<span class="s2">C     0.1354501    0.3335445    0.0000000 </span>
<span class="s2">O     0.1744673   -1.0774079    0.0000000 </span>
<span class="s2">H     0.6439155    0.7202929    0.8794450 </span>
<span class="s2">H     0.6439155    0.7202929   -0.8794450 </span>
<span class="s2">H    -0.8812042    0.7207713    0.0000000 </span>
<span class="s2">H    -0.7165441   -1.4174937    0.0000000 </span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">methanol_staggered</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;0 1</span>
<span class="s2">O     0.1640874    1.0771522    0.0000000 </span>
<span class="s2">C     0.1319097   -0.3310036    0.0000000 </span>
<span class="s2">H     1.1612146   -0.6758875    0.0000000 </span>
<span class="s2">H    -0.3605642   -0.7355506    0.8858582 </span>
<span class="s2">H    -0.3605642   -0.7355506   -0.8858582 </span>
<span class="s2">H    -0.7360833    1.4008402    0.0000000 </span>
<span class="s2">   &quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drawXYZSideBySide</span><span class="p">(</span><span class="n">methanol_eclipsed</span><span class="p">,</span> <span class="n">methanol_staggered</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div id="3dmolviewer_17020229273637311"  style="position: relative; width: 640px; height: 480px;">
        <p id="3dmolwarning_17020229273637311" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.0.3/3Dmol-min.js');
}

var viewer_17020229273637311 = null;
var warn = document.getElementById("3dmolwarning_17020229273637311");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
var viewergrid_17020229273637311 = null;
viewergrid_17020229273637311 = $3Dmol.createViewerGrid(document.getElementById("3dmolviewer_17020229273637311"),{rows: 1, cols: 2, control_all: true},{backgroundColor:"white"});
viewer_17020229273637311 = viewergrid_17020229273637311[0][0];
viewergrid_17020229273637311[0][0].zoomTo();viewergrid_17020229273637311[0][1].zoomTo();	viewergrid_17020229273637311[0][0].addModel("6\n\n C    0.007316057723    0.723251161055    0.000000000000\n O    0.046333257723   -0.687701238945    0.000000000000\n H    0.515781457723    1.109999561055    0.879445000000\n H    0.515781457723    1.109999561055   -0.879445000000\n H   -1.009338242277    1.110477961055    0.000000000000\n H   -0.844678142277   -1.027787038945    0.000000000000\n","xyz");
	viewergrid_17020229273637311[0][1].addModel("6\n\n O    0.042025923269    0.686693095375    0.000000000000\n C    0.009848223269   -0.721462704625    0.000000000000\n H    1.039153123269   -1.066346604625    0.000000000000\n H   -0.482625676731   -1.126009704625    0.885858200000\n H   -0.482625676731   -1.126009704625   -0.885858200000\n H   -0.858144776731    1.010381095375    0.000000000000\n","xyz");
	viewergrid_17020229273637311[0][0].setStyle({"stick": {}, "sphere": {"scale": 0.1}});
	viewergrid_17020229273637311[0][1].setStyle({"stick": {}, "sphere": {"scale": 0.1}});
	viewergrid_17020229273637311[0][0].zoomTo();
	viewergrid_17020229273637311[0][1].zoomTo();
viewergrid_17020229273637311[0][1].render();
viewergrid_17020229273637311[0][0].render();
});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">methods</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;pbe&#39;</span><span class="p">,</span> <span class="s1">&#39;b3lyp&#39;</span><span class="p">,</span> <span class="s1">&#39;mn15&#39;</span><span class="p">,</span><span class="s1">&#39;mp2&#39;</span><span class="p">,</span> <span class="s1">&#39;scan&#39;</span><span class="p">]</span><span class="c1">#These are the methods that we are going to compare</span>
<span class="n">energies</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1">#Here we will store the energies</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">set_output_file</span><span class="p">(</span><span class="s1">&#39;dft_methanol.log&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span> 
    <span class="c1"># we clone all the molecules as we want to start the geometry optimization from the same starting structure</span>
    <span class="n">eclipsed_opt</span> <span class="o">=</span> <span class="n">methanol_eclipsed</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">staggered_opt</span> <span class="o">=</span> <span class="n">methanol_staggered</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

    <span class="c1"># call psi4  single point energy calculation once per method</span>
    <span class="c1"># use def2-TZVP basis set</span>
    <span class="n">psi4</span><span class="o">.</span><span class="n">set_options</span><span class="p">({</span><span class="s1">&#39;dft_radial_points&#39;</span><span class="p">:</span><span class="mi">99</span><span class="p">,</span> <span class="s1">&#39;dft_spherical_points&#39;</span><span class="p">:</span> <span class="mi">590</span><span class="p">})</span>
    <span class="n">E_eclipsed</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">E_staggered</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># calculate the raction energy in kcal/mol </span>
    <span class="c1"># you can use psi4.constants.hartree2kcalmol for the unit conversion    </span>
    <span class="n">E_reaction</span> <span class="o">=</span> <span class="kc">None</span>
    
    <span class="n">energies</span><span class="p">[</span><span class="n">method</span><span class="p">]</span><span class="o">=</span> <span class="p">[</span><span class="n">E_eclipsed</span><span class="p">,</span> <span class="n">E_staggered</span><span class="p">,</span> <span class="n">E_reaction</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># insert the reference here</span>
<span class="n">energies</span><span class="p">[</span><span class="s1">&#39;reference&#39;</span><span class="p">]</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.01</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">energies</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E_eclipsed&#39;</span><span class="p">,</span> <span class="s1">&#39;E_staggered&#39;</span><span class="p">,</span> <span class="s1">&#39;E_reaction (kcal/mol)&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>E_eclipsed</th>
      <th>E_staggered</th>
      <th>E_reaction (kcal/mol)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pbe</th>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b3lyp</th>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mn15</th>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mp2</th>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>scan</th>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>reference</th>
      <td></td>
      <td></td>
      <td>-1.01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "compchem"
        },
        kernelOptions: {
            name: "compchem",
            path: "./Exercises/Ex7"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'compchem'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Ex7_errors.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">7.1. </span>Fixing errors in the calculations</p>
      </div>
    </a>
    <a class="right-next"
       href="Ex7_DFT_integration_grid.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7.3. </span>Integration grids</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dispersion-correction">7.2.1. Dispersion correction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accuracy-of-dft-swiss-army-knife-for-computational-chemistry">7.2.2. Accuracy of DFT: Swiss army knife for computational chemistry?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bde-cao-into-atomic-calcium-and-oxygen">7.2.3. BDE CaO into atomic calcium and oxygen</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interaction-of-two-ethane-molecules">7.2.4. Interaction of two Ethane molecules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eclipsed-staggered-methanol">7.2.5. Eclipsed/Staggered Methanol</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Laboratory of Computational Biochemistry and Chemistry  - Prof. Ursula Roethlisberger
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>