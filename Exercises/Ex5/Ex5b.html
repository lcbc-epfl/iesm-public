
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>6.2. Density Functional Theory 2 &#8212; Introduction to Electronic Structure Methods</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"ket": ["\\lvert #1 \\rangle", 1], "bra": ["\\langle #1 \\lvert", 1], "Ket": ["\\lvert #1 \\rangle", 1], "Bra": ["\\langle #1 \\lvert", 1], "braket": ["\\langle #1 \\lvert #2 \\rangle", 2], "hop": "\\hat{\\mathcal{H}}", "unit": "\\mathbbm{1}"}}, "tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="7. Troubleshooting, Pitfalls, Traps" href="../ex6.html" />
    <link rel="prev" title="6.1. DFT functionals" href="Ex5.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      <h1 class="site-logo" id="site-title">Introduction to Electronic Structure Methods</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Introduction to Electronic Structure Methods
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Exercises
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex1.html">
   1. Linear Algebra in Quantum Mechanics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex1/Ex1Theory.html">
     1.1. Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex1/Ex1Exercises.html">
     1.2. Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex1/Ex1.html">
     1.3. Working with vectors using Numpy
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex2.html">
   2. Hartree-Fock Calculations in
   <em>
    Psi4
   </em>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex2/Ex2.html">
     2.1. Basis Sets - Defining Vector Spaces
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex3.html">
   3. Large Basis Sets, Dissociation Energy and Geometry Optimisation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/Ex3.html">
     3.1. Effects of Basis Set Size: The Molecular Case
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/Ex3Diss.html">
     3.2. Recording a Dissociation Curve for H
     <span class="math notranslate nohighlight">
      \(_2\)
     </span>
     : RHF vs. UHF
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/Ex3GeoOpt.html">
     3.3. Geometry optimization of
     <span class="math notranslate nohighlight">
      \(H_2O\)
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex4.html">
   4. Post-Hartree Fock Methods: MPn and Configuration Interaction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/Ex4Theory.html">
     4.1. MÃ¸ller-Plesset Perturbation Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/BDE.html">
     4.2. Homolytic Cleavage of the C-F Bond
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/HNO3_Correlation.html">
     4.5. Correlation energy
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex4b.html">
   5. The hartree fock procedure in detail
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../Ex5.html">
   6. Density Functional Theory - Comparison with (Post) Hartree-Fock Methods
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Ex5.html">
     6.1. DFT functionals
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     6.2. Density Functional Theory 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex6.html">
   7. Troubleshooting, Pitfalls, Traps
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex6/Ex6.html">
     7.1. Fixing errors in the calculations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex6/Ex6_DFT_Hard_Easy.html">
     7.2. Hard and easy cases for DFT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex6/Ex6_DFT_integration_grid.html">
     7.3. Integration grids
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex7.html">
   8. Potential Energy Scans and Visualisation of Trajectories
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex7/Ex7.html">
     8.1. Potential Energy Scans and Visualisation of Trajectories
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex8.html">
   9. Finding Transition States and Barrier Heights: First Order Saddle Points
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex8/Ex8Theory.html">
     9.1. Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex8/Ex8.html">
     9.2. Locating Transition States: Constrained Optimisations
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Lecture
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Lecture/CC.html">
   Coupled cluster
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/Exercises/Ex5/Ex5b.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/lcbc-epfl/iesm-public"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/lcbc-epfl/iesm-public/issues/new?title=Issue%20on%20page%20%2FExercises/Ex5/Ex5b.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        <a class="jupyterhub-button" href="https://noto.epfl.ch/hub/user-redirect/git-pull?repo=https://github.com/lcbc-epfl/iesm-public&urlpath=lab/tree/iesm-public/iesm/Exercises/Ex5/Ex5b.ipynb&branch=deploy"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   6.2. Density Functional Theory 2
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#structural-parameters-of-no-3-cdot-performance-of-dft-hf-and-mp2">
     6.2.1. Structural Parameters of NO
     <span class="math notranslate nohighlight">
      \(_3\cdot\)
     </span>
     : Performance of DFT, HF and MP2
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hf">
     6.2.2. HF
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mp2">
     6.2.3. MP2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualizing-the-orbitals">
   6.3. Visualizing the orbitals
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dft">
     6.3.1. DFT
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="density-functional-theory-2">
<h1><span class="section-number">6.2. </span>Density Functional Theory 2<a class="headerlink" href="#density-functional-theory-2" title="Permalink to this headline">Â¶</a></h1>
<p>In this set of exercises, you will assess the performance of various
state-of-the-art density functionals in the prediction of geometric
properties, and you will again compare your results to both wavefunction
theory and experimental data.</p>
<div class="section" id="structural-parameters-of-no-3-cdot-performance-of-dft-hf-and-mp2">
<h2><span class="section-number">6.2.1. </span>Structural Parameters of NO<span class="math notranslate nohighlight">\(_3\cdot\)</span>: Performance of DFT, HF and MP2<a class="headerlink" href="#structural-parameters-of-no-3-cdot-performance-of-dft-hf-and-mp2" title="Permalink to this headline">Â¶</a></h2>
<p>Before diving into the theoretical aspects of exchange-correlation
functionals, you will put a representative selection of functionals to
good use in a notoriously tricky system, the NO<span class="math notranslate nohighlight">\(_3\cdot\)</span> radical.
Nitrite radicals are highly reactive species that are rapidly destroyed
by sunlight, but as the sun sets, they start to play an important role
in chemical transformations (in what is called the night-time chemistry
of the atmosphere) [^no3radical].</p>
<p>There exist various experimental and theoretical
studies of NO<span class="math notranslate nohighlight">\(_3\cdot\)</span> , with the experiment indicating a fully symmetric D<span class="math notranslate nohighlight">\(_3^h\)</span>
structure with equal N-O bond lengths of 1.24 Ã and O-N-O bond angles of
120<span class="math notranslate nohighlight">\(^\circ\)</span>.</p>
<p>In this exercise, you will be comparing the performance of
various DFT exchange-correlation functionals, Hartree-Fock theory and
MP2 in predicting these structural parameters.</p>
<p>[^no3radical] : <em>Phys. Chem. Chem. Phys.</em>, <strong>2014</strong>, 16, <em>19437</em></p>
<p>First, weâll import the required modules.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">psi4</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">py3Dmol</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>


<span class="n">psi4</span><span class="o">.</span><span class="n">set_memory</span><span class="p">(</span><span class="s1">&#39;2 GB&#39;</span><span class="p">)</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">set_num_threads</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">helpers</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi4</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;1.4rc2&#39;
</pre></div>
</div>
</div>
</div>
<p>This is our starting geometry.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radical</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">symmetry c1</span>
<span class="s2">0 2</span>
<span class="s2"> N     0.000000     0.000000     0.000000</span>
<span class="s2"> O     1.400000     0.000000     0.000000</span>
<span class="s2"> O    -1.000000     1.000000     0.000000</span>
<span class="s2"> O    -1.000000    -1.000000     0.000000</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="hf">
<h2><span class="section-number">6.2.2. </span>HF<a class="headerlink" href="#hf" title="Permalink to this headline">Â¶</a></h2>
<p>First, weâll do a hartree fock calculation. As this is a difficult system we make use of a second order SCF convergence method implemented in Psi4.</p>
<p>SOSCF makes use of the fact that the energy that we want to minimize in the SCF calculation has a gradient (and a hessian) both with respect to geometry changes and orbital changes.
In a standard SCF calculation as you get close to convergence the orbital changes will be very small.  When using SOSCF, Psi4 uses the orbital hessian to make the next orbital step when performing the SCF calculation. In the code, the energy is written as a taylor expansion of orbitals and truncated for all terms higher than second order. This helps in converging tricky systems but requires that one is already close to a minimum. So by setting <code class="docutils literal notranslate"><span class="pre">soscf</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code> by default the soscf procedure is switched on when the gradient RMS is below <span class="math notranslate nohighlight">\(1.0 \times 10^{-2}\)</span>. By specifying <code class="docutils literal notranslate"><span class="pre">soscf_max_iter</span></code> we increase the number of SOSCF steps from the default of 5 to 20.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;hf&quot;</span>

<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">set_output_file</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;radical_opt_</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s1">.log&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">set_options</span><span class="p">({</span><span class="s1">&#39;reference&#39;</span><span class="p">:</span><span class="s1">&#39;uhf&#39;</span><span class="p">,</span><span class="s1">&#39;guess&#39;</span><span class="p">:</span><span class="s1">&#39;gwh&#39;</span><span class="p">,</span> <span class="s1">&#39;soscf&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;soscf_max_iter&#39;</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;maxiter&#39;</span><span class="p">:</span><span class="mi">200</span><span class="p">})</span>
<span class="n">E_hf</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="s1">&#39;hf/6-31+G*&#39;</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="n">radical</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimizer: Optimization complete!
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E_hf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-278.8245365472743
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="mp2">
<h2><span class="section-number">6.2.3. </span>MP2<a class="headerlink" href="#mp2" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;mp2&quot;</span>


<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">clean_options</span><span class="p">()</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">set_output_file</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;radical_opt_</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s1">.log&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">set_options</span><span class="p">({</span><span class="s1">&#39;reference&#39;</span><span class="p">:</span><span class="s1">&#39;uhf&#39;</span><span class="p">,</span><span class="s1">&#39;guess&#39;</span><span class="p">:</span><span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="s1">&#39;mp2_type&#39;</span><span class="p">:</span><span class="s1">&#39;conv&#39;</span><span class="p">,</span> <span class="s1">&#39;maxiter&#39;</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;soscf&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;soscf_max_iter&#39;</span><span class="p">:</span><span class="mi">20</span><span class="p">})</span>
<span class="n">E_mp2</span><span class="p">,</span> <span class="n">wfn</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s1">/6-31+G*&#39;</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="n">radical</span><span class="p">,</span> <span class="n">return_wfn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimizer: Optimization complete!
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E_mp2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-279.5254305193196
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="visualizing-the-orbitals">
<h1><span class="section-number">6.3. </span>Visualizing the orbitals<a class="headerlink" href="#visualizing-the-orbitals" title="Permalink to this headline">Â¶</a></h1>
<p>In order to assess the reliability of an electronic structure
calculation, it is usually not sufficient to simply glance at the
optimised structure and energies. One should as well examine the
orbitals. This is also valid for DFT: Although the Kohn-Sham orbitals
lack, in a strict sense, any physical interpretation, experience shows
that they are <em>very close</em> to wavefunction-based single particle
orbitals (<em>cf.</em> chapter 5.3). Thus, the DFT Kohn-Sham orbitals provide a
useful interpretative tool to visualise changes in the electronic
structure between different species (or in a chemical transformation),
but one should bear in mind that they have to be interpreted with care.</p>
<p>Refer to section <span class="xref std std-ref">interpretation-orbital</span> for more details</p>
<p>In Psi4 we will use the <code class="docutils literal notranslate"><span class="pre">frontier_orbitals</span></code> setting, which produces <code class="docutils literal notranslate"><span class="pre">cube</span></code> representations of the frontier molecular orbitals. For closed shell species, the highest occupied (HOMO) and the lowest unoccupied (LUMO) alpha orbitals (ie. <span class="math notranslate nohighlight">\(\psi_\alpha(r)\)</span>) are printed, while for open shell species a total of (<span class="math notranslate nohighlight">\(4+M_s\)</span>) orbitals are printed (<span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> spin for both lowest virtual (LVMO) and highest doubly occupied orbitals (DOMO), along with all singly occupied (SOMO) orbitals).
The plot below will print <span class="math notranslate nohighlight">\(\alpha\)</span> spin orbitals in red and <span class="math notranslate nohighlight">\(\beta\)</span> spin orbitals in blue.</p>
<p>Unfortuneately, there is a bug in psi4 1.4rc2 when printing cube files for MP2 wavefunctions. We therefore provide you with the necessary cube files which you can visualize using the commands <code class="docutils literal notranslate"><span class="pre">findCubeFiles(pathToDirectory)</span></code> and <code class="docutils literal notranslate"><span class="pre">showOrbitals(pathToDirectory)</span></code></p>
<p>Using cubeprop you can also acces the electron density (<code class="docutils literal notranslate"><span class="pre">density</span></code>), the basis functions (<code class="docutils literal notranslate"><span class="pre">basis_functions</span></code>), the electrostatic potential (<code class="docutils literal notranslate"><span class="pre">esp</span></code>) and the a descriptor calculated from the frontier orbitals which is <span class="math notranslate nohighlight">\(f^2(r) = \rho_{\text{LUMO}}(r) - \rho_{\text{HOMO}}(r)\)</span> (<code class="docutils literal notranslate"><span class="pre">dual_descriptor</span></code>). This descriptor is a good measure of nucleophilicity and electrophilicity and is like both Fukui functions combined.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is the code to get the cube files printed, </span>
<span class="c1"># Due to a bug in Psi4 for mp2 those files are provided to you in the mp2-cube folder.</span>

<span class="c1">#psi4.set_options({&#39;cubeprop_tasks&#39;:[&#39;frontier_orbitals&#39;]})</span>
<span class="c1">#psi4.cubeprop(wfn)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">orbitals</span> <span class="o">=</span> <span class="n">findCubeFiles</span><span class="p">(</span><span class="s1">&#39;./mp2-cube/&#39;</span><span class="p">)</span>
<span class="n">show_orbitals</span><span class="p">(</span><span class="n">wd</span><span class="o">=</span><span class="s1">&#39;./mp2-cube/&#39;</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">radical</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "c5b52f3c06c94fe98c46a2956eca6af6", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drawXYZ_labeled</span><span class="p">(</span><span class="n">radical</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div id="3dmolviewer_16267912457531056"  style="position: relative; width: 400px; height: 400px">
        <p id="3dmolwarning_16267912457531056" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
      resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://3dmol.org/build/3Dmol.js');
}

var viewer_16267912457531056 = null;
var warn = document.getElementById("3dmolwarning_16267912457531056");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_16267912457531056 = $3Dmol.createViewer($("#3dmolviewer_16267912457531056"),{backgroundColor:"white"});
viewer_16267912457531056.zoomTo();
	viewer_16267912457531056.addModel("4\n\n N    0.092649223047   -0.054027832619    0.000000000000\n O   -0.049387034503   -1.263238389335    0.000000000000\n O    1.075119810439    0.665078359930    0.000000000000\n O   -1.106844426585    0.645459796641    0.000000000000\n","xyz");
	viewer_16267912457531056.addLabel("0",{"position": {"x": 0.09264922304760922, "y": -0.054027832619190023, "z": 0.0}, "inFront": true});
	viewer_16267912457531056.addLabel("1",{"position": {"x": -0.049387034503364846, "y": -1.2632383893376042, "z": 0.0}, "inFront": true});
	viewer_16267912457531056.addLabel("2",{"position": {"x": 1.0751198104417592, "y": 0.6650783599313785, "z": 0.0}, "inFront": true});
	viewer_16267912457531056.addLabel("3",{"position": {"x": -1.1068444265877362, "y": 0.6454597966422334, "z": 0.0}, "inFront": true});
	viewer_16267912457531056.setStyle({"stick": {}, "sphere": {"scale": 0.1}});
	viewer_16267912457531056.setStyle({"model": 0},{"stick": {"colorscheme": "yellowCarbon"}, "sphere": {"scale": 0.1}});
	viewer_16267912457531056.zoomTo();
viewer_16267912457531056.render();
});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert molecule coordinates to numpy array</span>
<span class="n">r_numpy</span> <span class="o">=</span> <span class="n">radical</span><span class="o">.</span><span class="n">to_arrays</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">hartree2A</span> 

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MP2 values&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;r1: </span><span class="si">{</span><span class="n">calculate_bond</span><span class="p">(</span><span class="n">r_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r_numpy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;r2: </span><span class="si">{</span><span class="n">calculate_bond</span><span class="p">(</span><span class="n">r_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r_numpy</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;r3: </span><span class="si">{</span><span class="n">calculate_bond</span><span class="p">(</span><span class="n">r_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r_numpy</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;O-N-O angle: </span><span class="si">{</span><span class="n">calculate_angle</span><span class="p">(</span><span class="n">r_numpy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">r_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r_numpy</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;O-N-O angle: </span><span class="si">{</span><span class="n">calculate_angle</span><span class="p">(</span><span class="n">r_numpy</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">r_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r_numpy</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MP2 values
1.2175239089801662
1.38854886806525
1.217522965392925
O-N-O angle: 132.901
O-N-O angle: 113.550
</pre></div>
</div>
</div>
</div>
<div class="section" id="dft">
<h2><span class="section-number">6.3.1. </span>DFT<a class="headerlink" href="#dft" title="Permalink to this headline">Â¶</a></h2>
<p>Run the same geometry optimization for two of the following density functionals (where the keyword differs from the functional abbreviation, it is given in parentheses): LDA (SVWN5), BLYP, BP86, PBE, B3LYP, B97-2, M06-L, M06-2X, TPSS, mPW1PW91, wb97x-d.</p>
<p>Your assistants will assign to you which functionals to use. For this small system, Hartree-Fock and MP2 will be surprisingly fast; however, you may rest assured that for larger molecules and basis sets, all the DFT methods will outperform MP2 in computational efficiency, with some of them even beating Hartree-Fock</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">clean_options</span><span class="p">()</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">set_output_file</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;radical_opt_</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s1">.log&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">set_options</span><span class="p">({</span><span class="s1">&#39;reference&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">})</span> <span class="c1"># Choose a reference here, for DFT it can be Unrestricted KS (uks), restricted (rks) or restricted open shell (roks)</span>
<span class="n">E_dft</span><span class="p">,</span> <span class="n">wfn</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;method/basis&#39;</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="n">radical</span><span class="p">,</span> <span class="n">return_wfn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimizer: Optimization complete!
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi4</span><span class="o">.</span><span class="n">set_options</span><span class="p">({</span><span class="s1">&#39;cubeprop_tasks&#39;</span><span class="p">:[</span><span class="s1">&#39;frontier_orbitals&#39;</span><span class="p">]})</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">cubeprop</span><span class="p">(</span><span class="n">wfn</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">orbitals</span> <span class="o">=</span> <span class="n">findCubeFiles</span><span class="p">()</span>
<span class="n">show_orbitals</span><span class="p">(</span><span class="n">mol</span><span class="o">=</span><span class="n">radical</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "97177575ff1f4c9daa61775e3c073a6a", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert molecule coordinates to numpy array</span>
<span class="n">r_numpy</span> <span class="o">=</span> <span class="n">radical</span><span class="o">.</span><span class="n">to_arrays</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">hartree2A</span> 

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DFT: B3LYP&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;r1: </span><span class="si">{</span><span class="n">calculate_bond</span><span class="p">(</span><span class="n">r_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r_numpy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;r2: </span><span class="si">{</span><span class="n">calculate_bond</span><span class="p">(</span><span class="n">r_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r_numpy</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;r3: </span><span class="si">{</span><span class="n">calculate_bond</span><span class="p">(</span><span class="n">r_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r_numpy</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;O-N-O angle: </span><span class="si">{</span><span class="n">calculate_angle</span><span class="p">(</span><span class="n">r_numpy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">r_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r_numpy</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;O-N-O angle: </span><span class="si">{</span><span class="n">calculate_angle</span><span class="p">(</span><span class="n">r_numpy</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">r_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r_numpy</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DFT: B3LYP
r1: 1.240
r2: 1.240
r3: 1.240
O-N-O angle: 119.998
O-N-O angle: 120.001
</pre></div>
</div>
</div>
</div>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Method:</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\phi_1\)</span> [<span class="math notranslate nohighlight">\(^\circ\)</span>]</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\phi_2\)</span> [<span class="math notranslate nohighlight">\(^\circ\)</span>]</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\mathbf{r}_1 (O-N)\)</span> [Ã]</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\mathbf{r}_2 (O-N)\)</span> [Ã]</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\mathbf{r}_3 (O-N)\)</span> [Ã]</p></th>
<th class="head"><p>Symmetry</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Exp.</p></td>
<td><p>120</p></td>
<td><p>120</p></td>
<td><p>1.24</p></td>
<td><p>1.24</p></td>
<td><p>1.24</p></td>
<td><p>D<span class="math notranslate nohighlight">\(_3^h\)</span></p></td>
</tr>
</tbody>
</table>
<div class="exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Compare the performance of the methods in predicting accurate
structures. For the DFT methods, specify what approximations are
used in the exchange functional (you may refer to <span class="xref std std-ref">dfttheory</span>). Is there a trend relating the complexity
of the exchange-correlation functional (LDA, GGA, hybrid, â¦) to
the quality of your results?</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Take a screenshot of the MP2 SOMO and include it in your report. Take a screenshot of one of the DFT SOMOs as well.</p>
<p>How do the orbitals differ from each other? How does the symmetry of the SOMO relate to the predicted structure?</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Explain the difference between static and dynamic correlation. Relate this to the different results you obtained for the nitrate radical. What kind of correlation do HF, MP2 and DFT take into account?</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise</p>
<p>If you needed a highly accurate structure and energy for  NO<span class="math notranslate nohighlight">\(_3\cdot\)</span>, which method would you use?</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "iesm"
        },
        kernelOptions: {
            kernelName: "iesm",
            path: "./Exercises/Ex5"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'iesm'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="Ex5.html" title="previous page"><span class="section-number">6.1. </span>DFT functionals</a>
    <a class='right-next' id="next-link" href="../ex6.html" title="next page"><span class="section-number">7. </span>Troubleshooting, Pitfalls, Traps</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Laboratory of Computational Biochemistry and Chemistry  - Prof. Ursula Roethlisberger<br/>
        
          <div class="extra_footer">
            <div class="container-lg mt-3 footer"> <div class="row"> <div class="col-xl-9 d-flex"> <div class="container"> <div class="row"> <div class="col-6 d-flex" style="justify-content:center"> <a href="https://lcbc.epfl.ch"> Laboratory of Computational Biochemistry and Chemistry</a></li>
</div> <div class="col-6 d-flex" style="justify-content:center"> <ul style="list-style:none"> <li> <a href="https://github.com/lcbc-epfl/iesm">GitHub </a> </li> </li> <li> <a href="https://doi.org/10.5281/zenodo.0000000"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.00000000.svg" alt="DOI"></a> </li> </ul> </div> </div> </div> </div> <div class="col-xl-3"> <a href="https://epfl.ch"><img src="https://www.epfl.ch/wp/5.5/wp-content/themes/wp-theme-2018/assets/svg/epfl-logo.svg?refresh=now" alt="EPFL Logo" style="padding:5px;height:33px;"></a> </div> </div> </div> <div class="row_footer my-3"> Dual licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative Commons Attribution Share Alike 4.0 International</a> (CC BY SA 4.0) and MIT license. (Except where indicated otherwise) </div>
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>