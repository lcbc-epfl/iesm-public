
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>6.2. Hard and easy cases for DFT &#8212; Introduction to Electronic Structure Methods</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"TeX": {"Macros": {"ket": ["\\lvert #1 \\rangle", 1], "bra": ["\\langle #1 \\lvert", 1], "Ket": ["\\lvert #1 \\rangle", 1], "Bra": ["\\langle #1 \\lvert", 1], "braket": ["\\langle #1 \\lvert #2 \\rangle", 2], "hop": "\\hat{\\mathcal{H}}", "unit": "\\mathbbm{1}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6.3. Integration grids" href="Ex6_DFT_integration_grid.html" />
    <link rel="prev" title="6.1. Fixing errors in the calculations" href="Ex6.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Introduction to Electronic Structure Methods</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Introduction to Electronic Structure Methods
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Exercises
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex2.html">
   1. Hartree-Fock Calculations in
   <em>
    Psi4
   </em>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex2/Ex2.html">
     1.1. Basis Sets - Defining Vector Spaces
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex3.html">
   2. Large Basis Sets, Dissociation Energy and Geometry Optimisation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/Ex3.html">
     2.1. Effects of Basis Set Size: The Molecular Case
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/Ex3Diss.html">
     2.2. Recording a Dissociation Curve for H
     <span class="math notranslate nohighlight">
      \(_2\)
     </span>
     : RHF vs. UHF
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/Ex3GeoOpt.html">
     2.3. Geometry optimization of
     <span class="math notranslate nohighlight">
      \(H_2O\)
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex4b.html">
   3. The hartree fock procedure in detail
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/HF.html">
     3.1. Hartree-Fock Procedure for Approximate Quantum Chemistry
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex4.html">
   4. Post-Hartree Fock Methods: MPn and Configuration Interaction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/Ex4Theory.html">
     4.1. Møller-Plesset Perturbation Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/BDE.html">
     4.2. Homolytic Cleavage of the C-F Bond
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/HNO3_Correlation.html">
     4.5. Correlation energy
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex5.html">
   5. Density Functional Theory - Comparison with (Post) Hartree-Fock Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../ex6.html">
   6. Troubleshooting, Pitfalls, Traps
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Ex6.html">
     6.1. Fixing errors in the calculations
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     6.2. Hard and easy cases for DFT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Ex6_DFT_integration_grid.html">
     6.3. Integration grids
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex7.html">
   7. Potential Energy Scans and Visualisation of Trajectories
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex7/Ex7.html">
     7.1. Potential Energy Scans and Visualisation of Trajectories
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ex8.html">
   8. Finding Transition States and Barrier Heights: First Order Saddle Points
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex8/Ex8Theory.html">
     8.1. Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex8/Ex8.html">
     8.2. Locating Transition States: Constrained Optimisations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex8/Backward.html">
     8.3. Recording a Potential Energy Profile: The Intrinsic Reaction Coordinate (IRC)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex8/Forward.html">
     8.5. Forward
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex8/Visualize.html">
     8.6. IRC analysis
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lecture
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Lecture/BasisFunctions.html">
   Basis functions in quantum chemistry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Lecture/CC.html">
   Coupled cluster
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Lecture/FAQ.html">
   FAQ
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://noto.epfl.ch/hub/user-redirect/git-pull?repo=https%3A//github.com/lcbc-epfl/iesm-public&urlpath=lab/tree/iesm-public/iesm/Exercises/Ex6/Ex6_DFT_Hard_Easy.ipynb&branch=main"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/lcbc-epfl/iesm-public"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/lcbc-epfl/iesm-public/issues/new?title=Issue%20on%20page%20%2FExercises/Ex6/Ex6_DFT_Hard_Easy.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/Exercises/Ex6/Ex6_DFT_Hard_Easy.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dispersion-correction">
   6.2.1. Dispersion correction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#accuracy-of-dft-swiss-army-knife-for-computational-chemistry">
   6.2.2. Accuracy of DFT: Swiss army knife for computational chemistry?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bde-cao-into-atomic-calcium-and-oxygen">
   6.2.3. BDE CaO into atomic calcium and oxygen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interaction-of-two-ethane-molecules">
   6.2.4. Interaction of two Ethane molecules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eclipsed-staggered-methanol">
   6.2.5. Eclipsed/Staggered Methanol
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Hard and easy cases for DFT</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dispersion-correction">
   6.2.1. Dispersion correction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#accuracy-of-dft-swiss-army-knife-for-computational-chemistry">
   6.2.2. Accuracy of DFT: Swiss army knife for computational chemistry?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bde-cao-into-atomic-calcium-and-oxygen">
   6.2.3. BDE CaO into atomic calcium and oxygen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interaction-of-two-ethane-molecules">
   6.2.4. Interaction of two Ethane molecules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eclipsed-staggered-methanol">
   6.2.5. Eclipsed/Staggered Methanol
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="hard-and-easy-cases-for-dft">
<h1><span class="section-number">6.2. </span>Hard and easy cases for DFT<a class="headerlink" href="#hard-and-easy-cases-for-dft" title="Permalink to this headline">#</a></h1>
<section id="dispersion-correction">
<h2><span class="section-number">6.2.1. </span>Dispersion correction<a class="headerlink" href="#dispersion-correction" title="Permalink to this headline">#</a></h2>
<p>Dispersion interactions are caused by long-range electron correlation  and decay asymptotically with
<span class="math notranslate nohighlight">\(E_{\text{disp}} \propto - C_6/R^6\)</span> (London interaction). As the distance between two electron clouds is reduced this dispersion interaction becomes part of the normal correlation energy for short e-e distances. The London part of the dispersion energy is not included in standard local density functionals. The inclusion of short/medium range dispersion depends on the functional. Semi-local functionals that include the gradient of the density or the kinetic energy density tend to do better in this regard. A proper description of dispersion requires non-local correlation functionals.</p>
<p>Dispersion is often synomously used with Van der Waals interaction, but technically this is not correct. Dispersion is a time-independent phenomen that one can observe e.g. for  non-overlapping, spherically-symmetric charge densities (e.g two argon atoms A and B at points <span class="math notranslate nohighlight">\(\vec{r}\)</span> and <span class="math notranslate nohighlight">\(\vec{r}'\)</span>). The dispersion interaction shows up as large density gradient in regions of space where the density itself is small.</p>
<p>This can be better described by newer exchange-correlation potentials having the following form</p>
<div class="math notranslate nohighlight">
\[
v_c^{\text{nl}}(\vec{r}) = \int f(\vec{r}, \vec{r}') dr'
\]</div>
<p>where a perturbation at <span class="math notranslate nohighlight">\(\vec{r}'\)</span> due to atom B, induces an exchange-correlation potential at <span class="math notranslate nohighlight">\(\vec{r}\)</span> on atom A, even at a great distance.
Examples for such functionals are <code class="docutils literal notranslate"><span class="pre">VV10</span></code> and <code class="docutils literal notranslate"><span class="pre">vdW-DF-10</span></code>.</p>
<p>A cheaper and simple solution is to use an empirical potential of the form <span class="math notranslate nohighlight">\(- C_6/R^6\)</span>.
A popular dispersion correction is DFT-D3 by Grimme and coworkers. Like other corrections of the DFT-D family, this is an additive correction.</p>
<div class="math notranslate nohighlight">
\[E_{\text{B3LYP-D3}} = E_{\text{B3LYP}} + E_{\text{D3, 2-body}} + E_{\text{ATM, 3-body}}\]</div>
<p>The dispersion correction consists of a two-body term plus a three-body term of the Axilrod-Teller-Muto (ATM) triple-dipole variety. If the BJ approach is used, a slightly different damping function is employed to make the potential finite (but non-zero) for <span class="math notranslate nohighlight">\(R_{AB} \rightarrow 0\)</span>. This is the preferred dispersion correction for most uses.</p>
<p>In Psi4 we can also add non-local density based correlation energy from the VV10 functional to e.g the b3lyp functional by using the following keyword <code class="docutils literal notranslate"><span class="pre">b3lyp-nl</span></code>.  The VV10 functional is less empirical than the DFT-D approaches, as it contains only two fitted parameters.</p>
</section>
<section id="accuracy-of-dft-swiss-army-knife-for-computational-chemistry">
<h2><span class="section-number">6.2.2. </span>Accuracy of DFT: Swiss army knife for computational chemistry?<a class="headerlink" href="#accuracy-of-dft-swiss-army-knife-for-computational-chemistry" title="Permalink to this headline">#</a></h2>
<p>DFT although fast and available in many quantum chemistry programs is not a universal solution for any system. In principle, DFT is exact. However, in practice, as we rely on density functional approximations (DFA), the results can vary widely, depending on the DFA used. DFA are often fit using reference data from databases containing atomization energies and various other data. In this example, we will look at three reactions using geometries obtained from quantum chemical reference datasets. For reasons of efficiency, we will only perform single point calculations using a variety of functionals to learn about some points that we need to be careful about when using DFT.</p>
<p>The reactions of interest are:</p>
<ol class="simple">
<li><p>Homolytic bond dissociation energy of CaO into atomic calcium and oxygen (taken from Minnesota 2015B database, 96.15 kcal mol<span class="math notranslate nohighlight">\(^{-1}\)</span>)</p></li>
<li><p>Interaction energy of two ethane molecules (taken from GMTKN55 database, -1.34 kcal mol<span class="math notranslate nohighlight">\(^{-1}\)</span>)</p></li>
<li><p>Energy difference between the staggered and eclipsed methanol conformations (taken from GMTKN55 database, -1.01 kcal mol<span class="math notranslate nohighlight">\(^{-1}\)</span>)</p></li>
</ol>
<p>Note, that one of the reactions is contained in the training data of one of the functionals that we will be using.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>These exercises are based on  <span id="id1"></span>.</p>
</aside>
<div class="exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Which of the reaction energies (i.e. the energy difference between product and reactants) do you think is most “difficult” to calculate? Rank them in order of increasing difficulty.</p>
<p>Difficult in this case refers to getting an accurate reaction energy with low absolute error to true energy (reference energy from the dataset). As chemical accuracy we usually use 1 kcal mol<span class="math notranslate nohighlight">\(^-1\)</span></p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Run the calculations below and check whether your assessment of the hard, medium and easy reactions is correct. Include the tables containing the calculated energies for the three problems in your report. Which functional do you think contained the reaction in its training data?</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Bonus Exercise</p>
<p>How could fortitous error cancellation help in getting good results when calculating reaction energies?</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Bonus Exercise</p>
<p>What is the impact of using the dispersion correction for the ethane complex? For what phenomena are such corrections relevant? Give a real world example system.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">psi4</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>


<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">helpers</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi4</span><span class="o">.</span><span class="n">set_num_threads</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">set_memory</span><span class="p">(</span><span class="s1">&#39;2 GB&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000000000
</pre></div>
</div>
</div>
</div>
</section>
<section id="bde-cao-into-atomic-calcium-and-oxygen">
<h2><span class="section-number">6.2.3. </span>BDE CaO into atomic calcium and oxygen<a class="headerlink" href="#bde-cao-into-atomic-calcium-and-oxygen" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cao</span><span class="o">=</span><span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">0 1</span>
<span class="s2">Ca 0.0000000 0.0000000 1.8210000</span>
<span class="s2">O 0.0000000 0.0000000 0.0000000</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ca</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">0 1</span>
<span class="s2">Ca   0.0   0.0   0.0</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">o</span><span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">0 3</span>
<span class="s2">O   0.0   0.0   0.0</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">methods</span> <span class="o">=</span><span class="p">[</span> <span class="s1">&#39;pbe&#39;</span><span class="p">,</span> <span class="s1">&#39;b3lyp&#39;</span><span class="p">,</span> <span class="s1">&#39;mn15&#39;</span><span class="p">,</span><span class="s1">&#39;mp2&#39;</span><span class="p">,</span> <span class="s1">&#39;scan&#39;</span><span class="p">]</span> <span class="c1">#These are the methods that we are going to use</span>
<span class="n">energies</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1">#Here we will store the energies</span>

<span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
    <span class="c1"># we clone all the molecules as we want to start the geometry optimization from the same starting structure</span>
    <span class="n">cao_opt</span> <span class="o">=</span> <span class="n">cao</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">ca_opt</span> <span class="o">=</span> <span class="n">ca</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">o_opt</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

    <span class="c1"># call psi4  single point energy calculation once per method</span>
    <span class="c1"># use def2-QZVP basis set    </span>
    <span class="n">psi4</span><span class="o">.</span><span class="n">set_options</span><span class="p">({</span><span class="s1">&#39;dft_radial_points&#39;</span><span class="p">:</span><span class="mi">99</span><span class="p">,</span> <span class="s1">&#39;dft_spherical_points&#39;</span><span class="p">:</span> <span class="mi">590</span><span class="p">,</span> <span class="s1">&#39;reference&#39;</span><span class="p">:</span><span class="s1">&#39;uks&#39;</span><span class="p">})</span>
    <span class="n">E_cao</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="n">method</span><span class="o">+</span><span class="s1">&#39;/def2-QZVP&#39;</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="n">cao_opt</span><span class="p">)</span>
    <span class="n">E_o</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="n">method</span><span class="o">+</span><span class="s1">&#39;/def2-QZVP&#39;</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="n">o_opt</span><span class="p">)</span>
    <span class="n">E_ca</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="n">method</span><span class="o">+</span><span class="s1">&#39;/def2-QZVP&#39;</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="n">ca_opt</span><span class="p">)</span>
    <span class="c1"># calculate the raction energy in kcal/mol </span>
    <span class="c1"># you can use psi4.constants.hartree2kcalmol for the unit conversion    </span>
    <span class="n">E_reaction</span> <span class="o">=</span> <span class="p">(</span><span class="n">E_o</span> <span class="o">+</span> <span class="n">E_ca</span> <span class="o">-</span> <span class="n">E_cao</span><span class="p">)</span><span class="o">*</span><span class="n">psi4</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">hartree2kcalmol</span>

    <span class="n">energies</span><span class="p">[</span><span class="n">method</span><span class="p">]</span><span class="o">=</span> <span class="p">[</span><span class="n">E_cao</span><span class="p">,</span> <span class="n">E_o</span><span class="p">,</span> <span class="n">E_ca</span><span class="p">,</span> <span class="n">E_reaction</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># insert the reference here</span>
<span class="n">energies</span><span class="p">[</span><span class="s1">&#39;reference&#39;</span><span class="p">]</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mf">96.15</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">energies</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E_CaO&#39;</span><span class="p">,</span> <span class="s1">&#39;E_O&#39;</span><span class="p">,</span> <span class="s1">&#39;E_Ca&#39;</span><span class="p">,</span> <span class="s1">&#39;E_reaction (kcal/mol)&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">clean_options</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="interaction-of-two-ethane-molecules">
<h2><span class="section-number">6.2.4. </span>Interaction of two Ethane molecules<a class="headerlink" href="#interaction-of-two-ethane-molecules" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dimer</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">symmetry c1</span>
<span class="s2">0 1</span>
<span class="s2">C  0.684160244353  0.337751120631  -1.9114826827</span>
<span class="s2">C  -0.684160244353  -0.337751120631  -1.9114826827</span>
<span class="s2">H  1.48964553204  -0.401434143375  -1.9114826827</span>
<span class="s2">H  0.812773290289  0.969660346322  -2.794291998</span>
<span class="s2">H  0.812773290289  0.969660346322  -1.0286733674</span>
<span class="s2">H  -1.48964553204  0.401434143375  -1.9114826827</span>
<span class="s2">H  -0.812773290289  -0.969660346322  -2.794291998</span>
<span class="s2">H  -0.812773290289  -0.969660346322  -1.0286733674</span>
<span class="s2">C  0.684160244353  -0.337751120631  1.9114826827</span>
<span class="s2">C  -0.684160244353  0.337751120631  1.9114826827</span>
<span class="s2">H  1.48964553204  0.401434143375  1.9114826827</span>
<span class="s2">H  0.812773290289  -0.969660346322  2.794291998</span>
<span class="s2">H  0.812773290289  -0.969660346322  1.0286733674</span>
<span class="s2">H  -1.48964553204  -0.401434143375  1.9114826827</span>
<span class="s2">H  -0.812773290289  0.969660346322  2.794291998</span>
<span class="s2">H  -0.812773290289  0.969660346322  1.0286733674</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">monomer</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">symmetry c1</span>
<span class="s2">0 1</span>
<span class="s2">C  0.0  0.0  0.762988243308</span>
<span class="s2">C  0.0  0.0  -0.762988243308</span>
<span class="s2">H  -0.882809099823  0.509690071426  1.1580401983</span>
<span class="s2">H  0.0  -1.01938014285  1.1580401983</span>
<span class="s2">H  0.882809099823  0.509690071426  1.1580401983</span>
<span class="s2">H  0.882809099823  -0.509690071426  -1.1580401983</span>
<span class="s2">H  -0.882809099823  -0.509690071426  -1.1580401983</span>
<span class="s2">H  0.0  1.01938014285  -1.1580401983</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drawXYZSideBySide</span><span class="p">(</span><span class="n">monomer</span><span class="p">,</span> <span class="n">dimer</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div id="3dmolviewer_16268584519424098"  style="position: relative; width: 640px; height: 480px">
        <p id="3dmolwarning_16268584519424098" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
      resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://3dmol.org/build/3Dmol.js');
}

var viewer_16268584519424098 = null;
var warn = document.getElementById("3dmolwarning_16268584519424098");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
var viewergrid_16268584519424098 = null;
viewergrid_16268584519424098 = $3Dmol.createViewerGrid($("#3dmolviewer_16268584519424098"),{rows: 1, cols: 2, control_all: true},{backgroundColor:"white"});
viewer_16268584519424098 = viewergrid_16268584519424098[0][0];
viewergrid_16268584519424098[0][0].zoomTo();viewergrid_16268584519424098[0][1].zoomTo();	viewergrid_16268584519424098[0][0].addModel("8\n\n C    0.000000000000    0.762988243308    0.000000000000\n C    0.000000000000   -0.762988243308    0.000000000000\n H    0.509690071425    1.158040198300    0.882809099823\n H    0.509690071425    1.158040198300   -0.882809099821\n H   -1.019380142852    1.158040198300   -0.000000000000\n H   -0.509690071425   -1.158040198300   -0.882809099823\n H    1.019380142852   -1.158040198300    0.000000000000\n H   -0.509690071425   -1.158040198300    0.882809099821\n","xyz");
	viewergrid_16268584519424098[0][1].addModel("16\n\n C    0.684160244353    0.337751120631   -1.911482682700\n C   -0.684160244353   -0.337751120631   -1.911482682700\n H    1.489645532040   -0.401434143375   -1.911482682700\n H    0.812773290289    0.969660346322   -2.794291998000\n H    0.812773290289    0.969660346322   -1.028673367400\n H   -1.489645532040    0.401434143375   -1.911482682700\n H   -0.812773290289   -0.969660346322   -2.794291998000\n H   -0.812773290289   -0.969660346322   -1.028673367400\n C    0.684160244353   -0.337751120631    1.911482682700\n C   -0.684160244353    0.337751120631    1.911482682700\n H    1.489645532040    0.401434143375    1.911482682700\n H    0.812773290289   -0.969660346322    2.794291998000\n H    0.812773290289   -0.969660346322    1.028673367400\n H   -1.489645532040   -0.401434143375    1.911482682700\n H   -0.812773290289    0.969660346322    2.794291998000\n H   -0.812773290289    0.969660346322    1.028673367400\n","xyz");
	viewergrid_16268584519424098[0][0].setStyle({"stick": {}});
	viewergrid_16268584519424098[0][1].setStyle({"stick": {}});
	viewergrid_16268584519424098[0][0].zoomTo();
	viewergrid_16268584519424098[0][1].zoomTo();
viewergrid_16268584519424098[0][1].render();
viewergrid_16268584519424098[0][0].render();
});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b3lyp&#39;</span><span class="p">,</span> <span class="s1">&#39;b3lyp-d3(bj)&#39;</span><span class="p">,</span> <span class="s1">&#39;b3lyp-nl&#39;</span> <span class="p">,</span><span class="s1">&#39;pbe&#39;</span><span class="p">,</span> <span class="s1">&#39;pbe-d3&#39;</span><span class="p">,</span> <span class="s1">&#39;mp2&#39;</span><span class="p">,</span> <span class="s1">&#39;svwn&#39;</span><span class="p">]</span> <span class="c1">#These are the methods that we are going to compare</span>
<span class="n">energies</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1">#Here we will store the energies</span>

<span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
    <span class="c1"># we clone all the molecules as we want to start the geometry optimization from the same starting structure</span>
    <span class="n">monomer_opt</span> <span class="o">=</span> <span class="n">monomer</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">dimer_opt</span> <span class="o">=</span> <span class="n">dimer</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

    <span class="c1"># call psi4  single point energy calculation once per method</span>
    <span class="c1"># use def2-TZVP basis set</span>
    <span class="n">E_monomer</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">E_dimer</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># calculate the raction energy in kcal/mol </span>
    <span class="c1"># you can use psi4.constants.hartree2kcalmol for the unit conversion    </span>
    <span class="n">E_reaction</span> <span class="o">=</span> <span class="kc">None</span>
    
    <span class="n">energies</span><span class="p">[</span><span class="n">method</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">E_dimer</span><span class="p">,</span> <span class="n">E_monomer</span><span class="p">,</span> <span class="n">E_reaction</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># insert the reference here</span>
<span class="n">energies</span><span class="p">[</span><span class="s1">&#39;reference&#39;</span><span class="p">]</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.34</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">energies</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E_dimer&#39;</span><span class="p">,</span> <span class="s1">&#39;E_monomer&#39;</span><span class="p">,</span> <span class="s1">&#39;E_interaction (kcal/mol)&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">clean_options</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="eclipsed-staggered-methanol">
<h2><span class="section-number">6.2.5. </span>Eclipsed/Staggered Methanol<a class="headerlink" href="#eclipsed-staggered-methanol" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">methanol_eclipsed</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">0 1</span>
<span class="s2">C     0.1354501    0.3335445    0.0000000 </span>
<span class="s2">O     0.1744673   -1.0774079    0.0000000 </span>
<span class="s2">H     0.6439155    0.7202929    0.8794450 </span>
<span class="s2">H     0.6439155    0.7202929   -0.8794450 </span>
<span class="s2">H    -0.8812042    0.7207713    0.0000000 </span>
<span class="s2">H    -0.7165441   -1.4174937    0.0000000 </span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">methanol_staggered</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;0 1</span>
<span class="s2">O     0.1640874    1.0771522    0.0000000 </span>
<span class="s2">C     0.1319097   -0.3310036    0.0000000 </span>
<span class="s2">H     1.1612146   -0.6758875    0.0000000 </span>
<span class="s2">H    -0.3605642   -0.7355506    0.8858582 </span>
<span class="s2">H    -0.3605642   -0.7355506   -0.8858582 </span>
<span class="s2">H    -0.7360833    1.4008402    0.0000000 </span>
<span class="s2">   &quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drawXYZSideBySide</span><span class="p">(</span><span class="n">methanol_eclipsed</span><span class="p">,</span> <span class="n">methanol_staggered</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div id="3dmolviewer_16268543724381888"  style="position: relative; width: 640px; height: 480px">
        <p id="3dmolwarning_16268543724381888" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
      resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://3dmol.org/build/3Dmol.js');
}

var viewer_16268543724381888 = null;
var warn = document.getElementById("3dmolwarning_16268543724381888");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
var viewergrid_16268543724381888 = null;
viewergrid_16268543724381888 = $3Dmol.createViewerGrid($("#3dmolviewer_16268543724381888"),{rows: 1, cols: 2, control_all: true},{backgroundColor:"white"});
viewer_16268543724381888 = viewergrid_16268543724381888[0][0];
viewergrid_16268543724381888[0][0].zoomTo();viewergrid_16268543724381888[0][1].zoomTo();	viewergrid_16268543724381888[0][0].addModel("6\n\n C    0.007316057723    0.723251161055    0.000000000000\n O    0.046333257723   -0.687701238945    0.000000000000\n H    0.515781457723    1.109999561055    0.879445000000\n H    0.515781457723    1.109999561055   -0.879445000000\n H   -1.009338242277    1.110477961055    0.000000000000\n H   -0.844678142277   -1.027787038945    0.000000000000\n","xyz");
	viewergrid_16268543724381888[0][1].addModel("6\n\n O    0.042025923269    0.686693095375    0.000000000000\n C    0.009848223269   -0.721462704625    0.000000000000\n H    1.039153123269   -1.066346604625    0.000000000000\n H   -0.482625676731   -1.126009704625    0.885858200000\n H   -0.482625676731   -1.126009704625   -0.885858200000\n H   -0.858144776731    1.010381095375    0.000000000000\n","xyz");
	viewergrid_16268543724381888[0][0].setStyle({"stick": {}});
	viewergrid_16268543724381888[0][1].setStyle({"stick": {}});
	viewergrid_16268543724381888[0][0].zoomTo();
	viewergrid_16268543724381888[0][1].zoomTo();
viewergrid_16268543724381888[0][1].render();
viewergrid_16268543724381888[0][0].render();
});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">methods</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;pbe&#39;</span><span class="p">,</span> <span class="s1">&#39;b3lyp&#39;</span><span class="p">,</span> <span class="s1">&#39;mn15&#39;</span><span class="p">,</span><span class="s1">&#39;mp2&#39;</span><span class="p">,</span> <span class="s1">&#39;scan&#39;</span><span class="p">]</span><span class="c1">#These are the methods that we are going to compare</span>
<span class="n">energies</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1">#Here we will store the energies</span>

<span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span> 
    <span class="c1"># we clone all the molecules as we want to start the geometry optimization from the same starting structure</span>
    <span class="n">eclipsed_opt</span> <span class="o">=</span> <span class="n">methanol_eclipsed</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">staggered_opt</span> <span class="o">=</span> <span class="n">methanol_staggered</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

    <span class="c1"># call psi4  single point energy calculation once per method</span>
    <span class="c1"># use def2-TZVP basis set</span>
    <span class="n">psi4</span><span class="o">.</span><span class="n">set_options</span><span class="p">({</span><span class="s1">&#39;dft_radial_points&#39;</span><span class="p">:</span><span class="mi">99</span><span class="p">,</span> <span class="s1">&#39;dft_spherical_points&#39;</span><span class="p">:</span> <span class="mi">590</span><span class="p">})</span>
    <span class="n">E_eclipsed</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">E_staggered</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># calculate the raction energy in kcal/mol </span>
    <span class="c1"># you can use psi4.constants.hartree2kcalmol for the unit conversion    </span>
    <span class="n">E_reaction</span> <span class="o">=</span> <span class="kc">None</span>
    
    <span class="n">energies</span><span class="p">[</span><span class="n">method</span><span class="p">]</span><span class="o">=</span> <span class="p">[</span><span class="n">E_eclipsed</span><span class="p">,</span> <span class="n">E_staggered</span><span class="p">,</span> <span class="n">E_reaction</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># insert the reference here</span>
<span class="n">energies</span><span class="p">[</span><span class="s1">&#39;reference&#39;</span><span class="p">]</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.01</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">energies</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E_eclipsed&#39;</span><span class="p">,</span> <span class="s1">&#39;E_staggered&#39;</span><span class="p">,</span> <span class="s1">&#39;E_reaction (kcal/mol)&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "iesm"
        },
        kernelOptions: {
            kernelName: "iesm",
            path: "./Exercises/Ex6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'iesm'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Ex6.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">6.1. </span>Fixing errors in the calculations</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Ex6_DFT_integration_grid.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6.3. </span>Integration grids</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Laboratory of Computational Biochemistry and Chemistry  - Prof. Ursula Roethlisberger<br/>
  
    <div class="extra_footer">
      <div class="container-lg mt-3 footer"> <div class="row"> <div class="col-xl-9 d-flex"> <div class="container"> <div class="row"> <div class="col-6 d-flex" style="justify-content:center"> <a href="https://lcbc.epfl.ch"> Laboratory of Computational Biochemistry and Chemistry</a></li>
</div> <div class="col-6 d-flex" style="justify-content:center"> <ul style="list-style:none"> <li> <a href="https://github.com/lcbc-epfl/iesm-public">GitHub </a> </li> </li> <!--<li> <a href="https://doi.org/10.5281/zenodo.0000000"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.00000000.svg" alt="DOI"></a> </li>--> </ul> </div> </div> </div> </div> <div class="col-xl-3"> <a href="https://epfl.ch"><img src="https://www.epfl.ch/wp/5.5/wp-content/themes/wp-theme-2018/assets/svg/epfl-logo.svg?refresh=now" alt="EPFL Logo" style="padding:5px;height:33px;"></a> </div> </div> </div> <div class="row_footer my-3"> Dual licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative Commons Attribution Share Alike 4.0 International</a> (CC BY SA 4.0) and MIT license. (Except where indicated otherwise) </div>
    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>